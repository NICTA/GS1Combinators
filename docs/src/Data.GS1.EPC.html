<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric              #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses      #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskell            #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-comment">-- | module containing error types, URI class, epc types</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- the types in this file cover all dimensions</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">GS1</span><span class="hs-operator">.</span><span class="hs-identifier">EPC</span><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-type">XMLSnippet</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#MissingTag"><span class="hs-identifier hs-type">MissingTag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#EventIdStr"><span class="hs-identifier hs-type">EventIdStr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-type">ItemReference</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#ExtensionDigit"><span class="hs-identifier hs-type">ExtensionDigit</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#SerialReference"><span class="hs-identifier hs-type">SerialReference</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#CheckDigit"><span class="hs-identifier hs-type">CheckDigit</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#Lot"><span class="hs-identifier hs-type">Lot</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#IndividualAssetReference"><span class="hs-identifier hs-type">IndividualAssetReference</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-type">SerialNumber</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#SGLNExtension"><span class="hs-identifier hs-type">SGLNExtension</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#Uom"><span class="hs-identifier hs-type">Uom</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#Amount"><span class="hs-identifier hs-type">Amount</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#AssetType"><span class="hs-identifier hs-type">AssetType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#Lng"><span class="hs-identifier hs-type">Lng</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#Lat"><span class="hs-identifier hs-type">Lat</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier hs-type">LocationReference</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#DocumentType"><span class="hs-identifier hs-type">DocumentType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#ServiceReference"><span class="hs-identifier hs-type">ServiceReference</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionId"><span class="hs-identifier hs-type">BizTransactionId</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#TransformationId"><span class="hs-identifier hs-type">TransformationId</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#EPCISTime"><span class="hs-identifier hs-type">EPCISTime</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#SGTINFilterValue"><span class="hs-identifier hs-type">SGTINFilterValue</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#InstanceLabelEPC"><span class="hs-identifier hs-type">InstanceLabelEPC</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#ClassLabelEPC"><span class="hs-identifier hs-type">ClassLabelEPC</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#LocationEPC"><span class="hs-identifier hs-type">LocationEPC</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#SourceDestType"><span class="hs-identifier hs-type">SourceDestType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#BusinessTransactionEPC"><span class="hs-identifier hs-type">BusinessTransactionEPC</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#LocationError"><span class="hs-identifier hs-type">LocationError</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#BizStep"><span class="hs-identifier hs-type">BizStep</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier hs-type">BizTransactionType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#BizTransaction"><span class="hs-identifier hs-type">BizTransaction</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#Action"><span class="hs-identifier hs-type">Action</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#Disposition"><span class="hs-identifier hs-type">Disposition</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier hs-var">readURI</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#renderURL"><span class="hs-identifier hs-var">renderURL</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#readURIClassLabelEPC"><span class="hs-identifier hs-var">readURIClassLabelEPC</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#readURIInstanceLabelEPC"><span class="hs-identifier hs-var">readURIInstanceLabelEPC</span></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.GS1.EPC.html#mkAction"><span class="hs-identifier hs-var">mkAction</span></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Lens</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Swagger</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Web</span><span class="hs-operator">.</span><span class="hs-identifier">HttpApiData</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Bifunctor</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">first</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span>           </span><a href="Data.GS1.Utils.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">GS1</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">UUID</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">UUID</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- import           Data.Monoid     hiding ((&lt;&gt;))</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Hashable</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hashable</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-keyword">newtype</span><span> </span><a name="XMLSnippet"><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier">XMLSnippet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="XMLSnippet"><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier">XMLSnippet</span></a></a><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-keyword">newtype</span><span> </span><a name="MissingTag"><a href="Data.GS1.EPC.html#MissingTag"><span class="hs-identifier">MissingTag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MissingTag"><a href="Data.GS1.EPC.html#MissingTag"><span class="hs-identifier">MissingTag</span></a></a><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span class="hs-keyword">newtype</span><span> </span><a name="EventIdStr"><a href="Data.GS1.EPC.html#EventIdStr"><span class="hs-identifier">EventIdStr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EventIdStr"><a href="Data.GS1.EPC.html#EventIdStr"><span class="hs-identifier">EventIdStr</span></a></a><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- add more type values to this if need be</span><span>
</span><a name="line-80"></a><span class="hs-keyword">data</span><span> </span><a name="ParseFailure"><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier">ParseFailure</span></a></a><span>
</span><a name="line-81"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="InvalidLength"><a href="Data.GS1.EPC.html#InvalidLength"><span class="hs-identifier">InvalidLength</span></a></a><span> </span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-type">XMLSnippet</span></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-comment">-- ^ Length is not correct</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InvalidFormat"><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier">InvalidFormat</span></a></a><span> </span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-type">XMLSnippet</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-comment">-- ^ Components Missing, incorrectly structured, wrong payload</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InvalidAction"><a href="Data.GS1.EPC.html#InvalidAction"><span class="hs-identifier">InvalidAction</span></a></a><span> </span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-type">XMLSnippet</span></a><span>
</span><a name="line-86"></a><span>  </span><span class="hs-comment">-- ^ When parsing an action failed</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InvalidBizTransaction"><a href="Data.GS1.EPC.html#InvalidBizTransaction"><span class="hs-identifier">InvalidBizTransaction</span></a></a><span> </span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-type">XMLSnippet</span></a><span>
</span><a name="line-88"></a><span>  </span><span class="hs-comment">-- ^ When parsing a bizTransaction failed</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InvalidEventId"><a href="Data.GS1.EPC.html#InvalidEventId"><span class="hs-identifier">InvalidEventId</span></a></a><span> </span><a href="Data.GS1.EPC.html#EventIdStr"><span class="hs-identifier hs-type">EventIdStr</span></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-comment">-- ^ When the ``eventId`` in the XML is not a valid UUID</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TimeZoneError"><a href="Data.GS1.EPC.html#TimeZoneError"><span class="hs-identifier">TimeZoneError</span></a></a><span> </span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-type">XMLSnippet</span></a><span>
</span><a name="line-92"></a><span>  </span><span class="hs-comment">-- ^ Error in parsing timezone</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TagNotFound"><a href="Data.GS1.EPC.html#TagNotFound"><span class="hs-identifier">TagNotFound</span></a></a><span> </span><a href="Data.GS1.EPC.html#MissingTag"><span class="hs-identifier hs-type">MissingTag</span></a><span>
</span><a name="line-94"></a><span>  </span><span class="hs-comment">-- ^ When a mandatory tag is not found</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MultipleTags"><a href="Data.GS1.EPC.html#MultipleTags"><span class="hs-identifier">MultipleTags</span></a></a><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-comment">-- ^ When more than the specified number of tags are present</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InvalidDispBizCombination"><a href="Data.GS1.EPC.html#InvalidDispBizCombination"><span class="hs-identifier">InvalidDispBizCombination</span></a></a><span> </span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-type">XMLSnippet</span></a><span>
</span><a name="line-98"></a><span>  </span><span class="hs-comment">-- ^ When the disposition does not go with the bizstep</span><span>
</span><a name="line-99"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ChildFailure"><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier">ChildFailure</span></a></a><span> </span><span class="hs-special">[</span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span class="hs-special">]</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-comment">-- ^ When there is a list of Parsefailures</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-comment">-- typically applicable to higher level structures,</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-comment">-- like DWhat, DWhere, etc</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>  </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><a name="local-6989586621679146815"><a href="#local-6989586621679146815"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-3458764513820541482"><span class="hs-operator">&lt;&gt;</span></a><span> </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><a name="local-6989586621679146816"><a href="#local-6989586621679146816"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679146815"><span class="hs-identifier hs-var">xs</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621679146816"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>  </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a name="local-6989586621679146817"><a href="#local-6989586621679146817"><span class="hs-identifier">y</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679146817"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-comment">-- Needed for mempty &lt;&gt; x = x law</span><span>
</span><a name="line-108"></a><span>  </span><a name="local-6989586621679146818"><a href="#local-6989586621679146818"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679146818"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-109"></a><span>  </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><a name="local-6989586621679146819"><a href="#local-6989586621679146819"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a name="local-6989586621679146820"><a href="#local-6989586621679146820"><span class="hs-identifier">y</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679146819"><span class="hs-identifier hs-var">xs</span></a><span class="hs-operator hs-var">++</span><span class="hs-special">[</span><a href="#local-6989586621679146820"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>  </span><a name="local-6989586621679146821"><a href="#local-6989586621679146821"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><a name="local-6989586621679146822"><a href="#local-6989586621679146822"><span class="hs-identifier">ys</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679146821"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679146822"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>  </span><a name="local-6989586621679146823"><a href="#local-6989586621679146823"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a name="local-6989586621679146824"><a href="#local-6989586621679146824"><span class="hs-identifier">y</span></a></a><span>                             </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679146823"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679146824"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-114"></a><span>  </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#ChildFailure"><span class="hs-identifier hs-var">ChildFailure</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-115"></a><span>  </span><a name="local-3458764513820541484"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- |Anything that could be converted into URI</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-keyword">class</span><span> </span><a name="URI"><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier">URI</span></a></a><span> </span><a name="local-6989586621679146813"><a href="#local-6989586621679146813"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-120"></a><span>  </span><span class="hs-pragma">{-# MINIMAL uriPrefix, uriSuffix, readURI #-}</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-identifier">uriPrefix</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679146813"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679146813"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-identifier">readURI</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="#local-6989586621679146813"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>  </span><span class="hs-comment">-- | Should not be directly implemented unless the format for URIs differs</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-comment">-- substantially from other URIs</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-identifier">renderURL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679146813"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-128"></a><span>  </span><a name="local-8214565720323921192"><a href="Data.GS1.EPC.html#renderURL"><span class="hs-identifier">renderURL</span></a></a><span> </span><a name="local-6989586621679146814"><a href="#local-6989586621679146814"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier hs-var">uriPrefix</span></a><span> </span><a href="#local-6989586621679146814"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="Data.GS1.EPC.html#dots"><span class="hs-identifier hs-var">dots</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier hs-var">uriSuffix</span></a><span> </span><a href="#local-6989586621679146814"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-identifier">dots</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-131"></a><a name="dots"><a href="Data.GS1.EPC.html#dots"><span class="hs-identifier">dots</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- makeInvalidLength :: [T.Text] -&gt; Either ParseFailure a</span><span>
</span><a name="line-134"></a><span class="hs-identifier">makeErrorType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-type">XMLSnippet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="#local-6989586621679146825"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-135"></a><a name="makeErrorType"><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier">makeErrorType</span></a></a><span> </span><a name="local-6989586621679146826"><a href="#local-6989586621679146826"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679146827"><a href="#local-6989586621679146827"><span class="hs-identifier">snippets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679146826"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-var">XMLSnippet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#dots"><span class="hs-identifier hs-var">dots</span></a><span> </span><a href="#local-6989586621679146827"><span class="hs-identifier hs-var">snippets</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- |Assigned by a GS1 Member Organisation to a user/subscriber</span><span>
</span><a name="line-139"></a><span class="hs-keyword">newtype</span><span> </span><a name="GS1CompanyPrefix"><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier">GS1CompanyPrefix</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="GS1CompanyPrefix"><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier">GS1CompanyPrefix</span></a></a><span> </span><span class="hs-special">{</span><a name="unGS1CompanyPrefix"><a href="Data.GS1.EPC.html#unGS1CompanyPrefix"><span class="hs-identifier">unGS1CompanyPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-140"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span class="hs-keyword">newtype</span><span> </span><a name="ItemReference"><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier">ItemReference</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a name="ItemReference"><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier">ItemReference</span></a></a><span> </span><span class="hs-special">{</span><a name="unItemReference"><a href="Data.GS1.EPC.html#unItemReference"><span class="hs-identifier">unItemReference</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span class="hs-keyword">newtype</span><span> </span><a name="ExtensionDigit"><a href="Data.GS1.EPC.html#ExtensionDigit"><span class="hs-identifier">ExtensionDigit</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="ExtensionDigit"><a href="Data.GS1.EPC.html#ExtensionDigit"><span class="hs-identifier">ExtensionDigit</span></a></a><span> </span><span class="hs-special">{</span><a name="unExtensionDigit"><a href="Data.GS1.EPC.html#unExtensionDigit"><span class="hs-identifier">unExtensionDigit</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">}</span><span>
</span><a name="line-144"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span class="hs-keyword">newtype</span><span> </span><a name="SerialReference"><a href="Data.GS1.EPC.html#SerialReference"><span class="hs-identifier">SerialReference</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a name="SerialReference"><a href="Data.GS1.EPC.html#SerialReference"><span class="hs-identifier">SerialReference</span></a></a><span> </span><span class="hs-special">{</span><a name="unSerialReference"><a href="Data.GS1.EPC.html#unSerialReference"><span class="hs-identifier">unSerialReference</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- |Calculated according to an algorithm https://en.wikipedia.org/wiki/Global_Location_Number</span><span>
</span><a name="line-149"></a><span class="hs-keyword">newtype</span><span> </span><a name="CheckDigit"><a href="Data.GS1.EPC.html#CheckDigit"><span class="hs-identifier">CheckDigit</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a name="CheckDigit"><a href="Data.GS1.EPC.html#CheckDigit"><span class="hs-identifier">CheckDigit</span></a></a><span> </span><span class="hs-special">{</span><a name="unCheckDigit"><a href="Data.GS1.EPC.html#unCheckDigit"><span class="hs-identifier">unCheckDigit</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">}</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span class="hs-keyword">newtype</span><span> </span><a name="Lot"><a href="Data.GS1.EPC.html#Lot"><span class="hs-identifier">Lot</span></a></a><span>                      </span><span class="hs-glyph">=</span><span> </span><a name="Lot"><a href="Data.GS1.EPC.html#Lot"><span class="hs-identifier">Lot</span></a></a><span> </span><span class="hs-special">{</span><a name="unLot"><a href="Data.GS1.EPC.html#unLot"><span class="hs-identifier">unLot</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-keyword">newtype</span><span> </span><a name="IndividualAssetReference"><a href="Data.GS1.EPC.html#IndividualAssetReference"><span class="hs-identifier">IndividualAssetReference</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-154"></a><span>  </span><a name="IndividualAssetReference"><a href="Data.GS1.EPC.html#IndividualAssetReference"><span class="hs-identifier">IndividualAssetReference</span></a></a><span> </span><span class="hs-special">{</span><a name="unIndividualAssetReference"><a href="Data.GS1.EPC.html#unIndividualAssetReference"><span class="hs-identifier">unIndividualAssetReference</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span class="hs-keyword">newtype</span><span> </span><a name="SerialNumber"><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier">SerialNumber</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a name="SerialNumber"><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier">SerialNumber</span></a></a><span> </span><span class="hs-special">{</span><a name="unSerialNumber"><a href="Data.GS1.EPC.html#unSerialNumber"><span class="hs-identifier">unSerialNumber</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span class="hs-keyword">newtype</span><span> </span><a name="SGLNExtension"><a href="Data.GS1.EPC.html#SGLNExtension"><span class="hs-identifier">SGLNExtension</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><a name="SGLNExtension"><a href="Data.GS1.EPC.html#SGLNExtension"><span class="hs-identifier">SGLNExtension</span></a></a><span> </span><span class="hs-special">{</span><a name="unSGLNExtension"><a href="Data.GS1.EPC.html#unSGLNExtension"><span class="hs-identifier">unSGLNExtension</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-159"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-162"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToParamSchema</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-163"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-type">ItemReference</span></a><span>
</span><a name="line-164"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#ExtensionDigit"><span class="hs-identifier hs-type">ExtensionDigit</span></a><span>
</span><a name="line-165"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#SerialReference"><span class="hs-identifier hs-type">SerialReference</span></a><span>
</span><a name="line-166"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#CheckDigit"><span class="hs-identifier hs-type">CheckDigit</span></a><span>
</span><a name="line-167"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#Lot"><span class="hs-identifier hs-type">Lot</span></a><span>
</span><a name="line-168"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#IndividualAssetReference"><span class="hs-identifier hs-type">IndividualAssetReference</span></a><span>
</span><a name="line-169"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-type">SerialNumber</span></a><span>
</span><a name="line-170"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#SGLNExtension"><span class="hs-identifier hs-type">SGLNExtension</span></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-keyword">data</span><span> </span><a name="SGTINFilterValue"><a href="Data.GS1.EPC.html#SGTINFilterValue"><span class="hs-identifier">SGTINFilterValue</span></a></a><span>
</span><a name="line-173"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="AllOthers"><a href="Data.GS1.EPC.html#AllOthers"><span class="hs-identifier">AllOthers</span></a></a><span>
</span><a name="line-174"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="POSTradeItem"><a href="Data.GS1.EPC.html#POSTradeItem"><span class="hs-identifier">POSTradeItem</span></a></a><span>
</span><a name="line-175"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FullCaseForTransport"><a href="Data.GS1.EPC.html#FullCaseForTransport"><span class="hs-identifier">FullCaseForTransport</span></a></a><span>
</span><a name="line-176"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Reserved1"><a href="Data.GS1.EPC.html#Reserved1"><span class="hs-identifier">Reserved1</span></a></a><span>
</span><a name="line-177"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InnerPackTradeItemGroupingForHandling"><a href="Data.GS1.EPC.html#InnerPackTradeItemGroupingForHandling"><span class="hs-identifier">InnerPackTradeItemGroupingForHandling</span></a></a><span>
</span><a name="line-178"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Reserved2"><a href="Data.GS1.EPC.html#Reserved2"><span class="hs-identifier">Reserved2</span></a></a><span>
</span><a name="line-179"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnitLoad"><a href="Data.GS1.EPC.html#UnitLoad"><span class="hs-identifier">UnitLoad</span></a></a><span>
</span><a name="line-180"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnitInsideTradeItemOrComponentInsideAProductNotIntendedForIndividualSale"><a href="Data.GS1.EPC.html#UnitInsideTradeItemOrComponentInsideAProductNotIntendedForIndividualSale"><span class="hs-identifier">UnitInsideTradeItemOrComponentInsideAProductNotIntendedForIndividualSale</span></a></a><span>
</span><a name="line-181"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679153241"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679153241"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679153241"><span class="hs-identifier hs-var">SGTINFilterValue</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#SGTINFilterValue"><span class="hs-identifier hs-type">SGTINFilterValue</span></a><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">{-
&#9632; The GS1 Company Prefix, assigned by GS1 to a managing entity.
  This is the same as the GS1 Company Prefix digits within a GS1 SSCC key.

&#9632; The Serial Reference, assigned by the managing entity to a particular
  logistics handling unit. The Serial Reference as it appears
  in the EPC URI is derived from the SSCC by concatenating the
  Extension Digit of the SSCC and the Serial Reference digits,
  and treating the result as a single numeric string.
-}</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-keyword">newtype</span><span> </span><a name="Uom"><a href="Data.GS1.EPC.html#Uom"><span class="hs-identifier">Uom</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a name="Uom"><a href="Data.GS1.EPC.html#Uom"><span class="hs-identifier">Uom</span></a></a><span> </span><span class="hs-special">{</span><a name="unUom"><a href="Data.GS1.EPC.html#unUom"><span class="hs-identifier">unUom</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-197"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span class="hs-keyword">newtype</span><span> </span><a name="Amount"><a href="Data.GS1.EPC.html#Amount"><span class="hs-identifier">Amount</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Amount"><a href="Data.GS1.EPC.html#Amount"><span class="hs-identifier">Amount</span></a></a><span> </span><span class="hs-special">{</span><a name="unAmount"><a href="Data.GS1.EPC.html#unAmount"><span class="hs-identifier">unAmount</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">}</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span class="hs-keyword">newtype</span><span> </span><a name="AssetType"><a href="Data.GS1.EPC.html#AssetType"><span class="hs-identifier">AssetType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AssetType"><a href="Data.GS1.EPC.html#AssetType"><span class="hs-identifier">AssetType</span></a></a><span> </span><span class="hs-special">{</span><a name="unAssetType"><a href="Data.GS1.EPC.html#unAssetType"><span class="hs-identifier">unAssetType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-201"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#Amount"><span class="hs-identifier hs-type">Amount</span></a><span>
</span><a name="line-204"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#Uom"><span class="hs-identifier hs-type">Uom</span></a><span>
</span><a name="line-205"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#AssetType"><span class="hs-identifier hs-type">AssetType</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- | A quantity can be either the amount and the unit of measurement,</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- or the item count.</span><span>
</span><a name="line-209"></a><span class="hs-keyword">data</span><span> </span><a name="Quantity"><a href="Data.GS1.EPC.html#Quantity"><span class="hs-identifier">Quantity</span></a></a><span>
</span><a name="line-210"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="MeasuredQuantity"><a href="Data.GS1.EPC.html#MeasuredQuantity"><span class="hs-identifier">MeasuredQuantity</span></a></a><span>
</span><a name="line-211"></a><span>    </span><span class="hs-special">{</span><span>
</span><a name="line-212"></a><span>      </span><a name="_quantityAmount"><a href="Data.GS1.EPC.html#_quantityAmount"><span class="hs-identifier">_quantityAmount</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#Amount"><span class="hs-identifier hs-type">Amount</span></a><span>
</span><a name="line-213"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_quantityUom"><a href="Data.GS1.EPC.html#_quantityUom"><span class="hs-identifier">_quantityUom</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#Uom"><span class="hs-identifier hs-type">Uom</span></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ItemCount"><a href="Data.GS1.EPC.html#ItemCount"><span class="hs-identifier">ItemCount</span></a></a><span>
</span><a name="line-216"></a><span>    </span><span class="hs-special">{</span><span>
</span><a name="line-217"></a><span>      </span><a name="_quantityCount"><a href="Data.GS1.EPC.html#_quantityCount"><span class="hs-identifier">_quantityCount</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-218"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679155036"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679155036"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679155036"><span class="hs-identifier hs-var">Quantity</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- Given a suffix/uri body, returns a list of strings separated by &quot;.&quot;</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- The separator should be passed on as an argument to this function in order</span><span>
</span><a name="line-225"></a><span class="hs-comment">-- to make it more generalised</span><span>
</span><a name="line-226"></a><span class="hs-identifier">getSuffixTokens</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-227"></a><a name="getSuffixTokens"><a href="Data.GS1.EPC.html#getSuffixTokens"><span class="hs-identifier">getSuffixTokens</span></a></a><span> </span><a name="local-6989586621679155057"><a href="#local-6989586621679155057"><span class="hs-identifier">suffix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621679155057"><span class="hs-identifier hs-var">suffix</span></a><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">--GS1_EPC_TDS_i1_10.pdf (page 27)</span><span>
</span><a name="line-230"></a><span class="hs-keyword">data</span><span> </span><a name="ClassLabelEPC"><a href="Data.GS1.EPC.html#ClassLabelEPC"><span class="hs-identifier">ClassLabelEPC</span></a></a><span>
</span><a name="line-231"></a><span>  </span><span class="hs-comment">-- | LGTIN = GTIN + Batch/Lot scheme is used to denote a class of objects</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-comment">-- belonging to a given batch or lot of a given GTIN</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LGTIN"><a href="Data.GS1.EPC.html#LGTIN"><span class="hs-identifier">LGTIN</span></a></a><span>
</span><a name="line-234"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_lgtinCompanyPrefix"><a href="Data.GS1.EPC.html#_lgtinCompanyPrefix"><span class="hs-identifier">_lgtinCompanyPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-235"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_lgtinItemReference"><a href="Data.GS1.EPC.html#_lgtinItemReference"><span class="hs-identifier">_lgtinItemReference</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-type">ItemReference</span></a><span>
</span><a name="line-236"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_lgtinLot"><a href="Data.GS1.EPC.html#_lgtinLot"><span class="hs-identifier">_lgtinLot</span></a></a><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#Lot"><span class="hs-identifier hs-type">Lot</span></a><span>
</span><a name="line-237"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-238"></a><span>    </span><span class="hs-comment">-- | Class SGTIN.</span><span>
</span><a name="line-239"></a><span>    </span><span class="hs-comment">-- e.g. olives in a vat, harvested in April 2017</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CSGTIN"><a href="Data.GS1.EPC.html#CSGTIN"><span class="hs-identifier">CSGTIN</span></a></a><span>
</span><a name="line-241"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_csgtinCompanyPrefix"><a href="Data.GS1.EPC.html#_csgtinCompanyPrefix"><span class="hs-identifier">_csgtinCompanyPrefix</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-242"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_csgtinSgtinFilterValue"><a href="Data.GS1.EPC.html#_csgtinSgtinFilterValue"><span class="hs-identifier">_csgtinSgtinFilterValue</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#SGTINFilterValue"><span class="hs-identifier hs-type">SGTINFilterValue</span></a><span>
</span><a name="line-243"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_csgtinItemReference"><a href="Data.GS1.EPC.html#_csgtinItemReference"><span class="hs-identifier">_csgtinItemReference</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-type">ItemReference</span></a><span>
</span><a name="line-244"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span> </span><a href="Data.GS1.EPC.html#ClassLabelEPC"><span class="hs-identifier hs-type">ClassLabelEPC</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-248"></a><span>  </span><a name="local-8214565720323921189"><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier">uriPrefix</span></a></a><span> </span><a href="Data.GS1.EPC.html#LGTIN"><span class="hs-identifier hs-var">LGTIN</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:class:lgtin:&quot;</span><span>
</span><a name="line-249"></a><span>  </span><span class="hs-identifier">uriPrefix</span><span> </span><a href="Data.GS1.EPC.html#CSGTIN"><span class="hs-identifier hs-var">CSGTIN</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:idpat:sgtin:&quot;</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span>  </span><a name="local-8214565720323921190"><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier">uriSuffix</span></a></a><span>
</span><a name="line-252"></a><span>    </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#LGTIN"><span class="hs-identifier hs-var">LGTIN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679155051"><a href="#local-6989586621679155051"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-var">ItemReference</span></a><span> </span><a name="local-6989586621679155052"><a href="#local-6989586621679155052"><span class="hs-identifier">itemReference</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#Lot"><span class="hs-identifier hs-var">Lot</span></a><span> </span><a name="local-6989586621679155053"><a href="#local-6989586621679155053"><span class="hs-identifier">lot</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-253"></a><span>      </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679155051"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679155052"><span class="hs-identifier hs-var">itemReference</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679155053"><span class="hs-identifier hs-var">lot</span></a><span class="hs-special">]</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span>
</span><a name="line-255"></a><span>    </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#CSGTIN"><span class="hs-identifier hs-var">CSGTIN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679155054"><a href="#local-6989586621679155054"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-var">ItemReference</span></a><span> </span><a name="local-6989586621679155055"><a href="#local-6989586621679155055"><span class="hs-identifier">itemReference</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-256"></a><span>      </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679155054"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679155055"><span class="hs-identifier hs-var">itemReference</span></a><span class="hs-special">]</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span>  </span><a name="local-8214565720323921191"><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier">readURI</span></a></a><span> </span><a name="local-6989586621679155056"><a href="#local-6989586621679155056"><span class="hs-identifier">epcStr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#readURIClassLabelEPC"><span class="hs-identifier hs-var">readURIClassLabelEPC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><a href="#local-6989586621679155056"><span class="hs-identifier hs-var">epcStr</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-- implement reader for :idpat:sgtin:</span><span>
</span><a name="line-262"></a><span class="hs-identifier">readURIClassLabelEPC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#ClassLabelEPC"><span class="hs-identifier hs-type">ClassLabelEPC</span></a><span>
</span><a name="line-263"></a><a name="readURIClassLabelEPC"><a href="Data.GS1.EPC.html#readURIClassLabelEPC"><span class="hs-identifier">readURIClassLabelEPC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;urn&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;epc&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;class&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;lgtin&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679155058"><a href="#local-6989586621679155058"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-264"></a><span>  </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#LGTIN"><span class="hs-identifier hs-var">LGTIN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679155059"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-var">ItemReference</span></a><span> </span><a href="#local-6989586621679155060"><span class="hs-identifier hs-var">itemReference</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#Lot"><span class="hs-identifier hs-var">Lot</span></a><span> </span><a href="#local-6989586621679155061"><span class="hs-identifier hs-var">lot</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679155059"><a href="#local-6989586621679155059"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679155060"><a href="#local-6989586621679155060"><span class="hs-identifier">itemReference</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679155061"><a href="#local-6989586621679155061"><span class="hs-identifier">lot</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#getSuffixTokens"><span class="hs-identifier hs-var">getSuffixTokens</span></a><span> </span><a href="#local-6989586621679155058"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-266"></a><span class="hs-identifier">readURIClassLabelEPC</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;urn&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;epc&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;idpat&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;sgtin&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679155062"><a href="#local-6989586621679155062"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-267"></a><span>  </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#CSGTIN"><span class="hs-identifier hs-var">CSGTIN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679155063"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-var">ItemReference</span></a><span> </span><a href="#local-6989586621679155064"><span class="hs-identifier hs-var">itemReference</span></a><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155063"><a href="#local-6989586621679155063"><span class="hs-identifier">pfix</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679155064"><a href="#local-6989586621679155064"><span class="hs-identifier">itemReference</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#getSuffixTokens"><span class="hs-identifier hs-var">getSuffixTokens</span></a><span> </span><a href="#local-6989586621679155062"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-269"></a><span class="hs-identifier">readURIClassLabelEPC</span><span> </span><a name="local-6989586621679155065"><a href="#local-6989586621679155065"><span class="hs-identifier">xSnippet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><a href="#local-6989586621679155065"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679156027"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679156027"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679156027"><span class="hs-identifier hs-var">ClassLabelEPC</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#ClassLabelEPC"><span class="hs-identifier hs-type">ClassLabelEPC</span></a><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-keyword">data</span><span> </span><a name="InstanceLabelEPC"><a href="Data.GS1.EPC.html#InstanceLabelEPC"><span class="hs-identifier">InstanceLabelEPC</span></a></a><span>
</span><a name="line-277"></a><span>  </span><span class="hs-comment">-- | Global Individual Asset Identifier,</span><span>
</span><a name="line-278"></a><span>  </span><span class="hs-comment">--  e.g. bucket for olives</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="GIAI"><a href="Data.GS1.EPC.html#GIAI"><span class="hs-identifier">GIAI</span></a></a><span>
</span><a name="line-280"></a><span>    </span><span class="hs-special">{</span><span>
</span><a name="line-281"></a><span>      </span><a name="_giaiCompanyPrefix"><a href="Data.GS1.EPC.html#_giaiCompanyPrefix"><span class="hs-identifier">_giaiCompanyPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-282"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_giaiSerialNum"><a href="Data.GS1.EPC.html#_giaiSerialNum"><span class="hs-identifier">_giaiSerialNum</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-type">SerialNumber</span></a><span>
</span><a name="line-283"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-284"></a><span>  </span><span class="hs-comment">-- | Serial Shipping Container Code</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SSCC"><a href="Data.GS1.EPC.html#SSCC"><span class="hs-identifier">SSCC</span></a></a><span>
</span><a name="line-286"></a><span>    </span><span class="hs-special">{</span><span>
</span><a name="line-287"></a><span>      </span><a name="_ssccCompanyPrefix"><a href="Data.GS1.EPC.html#_ssccCompanyPrefix"><span class="hs-identifier">_ssccCompanyPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-288"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_ssccSerialNum"><a href="Data.GS1.EPC.html#_ssccSerialNum"><span class="hs-identifier">_ssccSerialNum</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-type">SerialNumber</span></a><span>
</span><a name="line-289"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-comment">-- | Serialsed Global Trade Item Number</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SGTIN"><a href="Data.GS1.EPC.html#SGTIN"><span class="hs-identifier">SGTIN</span></a></a><span>
</span><a name="line-292"></a><span>    </span><span class="hs-special">{</span><span>
</span><a name="line-293"></a><span>      </span><a name="_sgtinCompanyPrefix"><a href="Data.GS1.EPC.html#_sgtinCompanyPrefix"><span class="hs-identifier">_sgtinCompanyPrefix</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-294"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_sgtinSgtinFilterValue"><a href="Data.GS1.EPC.html#_sgtinSgtinFilterValue"><span class="hs-identifier">_sgtinSgtinFilterValue</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#SGTINFilterValue"><span class="hs-identifier hs-type">SGTINFilterValue</span></a><span>
</span><a name="line-295"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_sgtinItemReference"><a href="Data.GS1.EPC.html#_sgtinItemReference"><span class="hs-identifier">_sgtinItemReference</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-type">ItemReference</span></a><span>
</span><a name="line-296"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_sgtinSerialNum"><a href="Data.GS1.EPC.html#_sgtinSerialNum"><span class="hs-identifier">_sgtinSerialNum</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-type">SerialNumber</span></a><span>
</span><a name="line-297"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-298"></a><span>  </span><span class="hs-comment">-- | Global Returnable Asset Identifier</span><span>
</span><a name="line-299"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GRAI"><a href="Data.GS1.EPC.html#GRAI"><span class="hs-identifier">GRAI</span></a></a><span>
</span><a name="line-300"></a><span>    </span><span class="hs-special">{</span><span>
</span><a name="line-301"></a><span>      </span><a name="_graiCompanyPrefix"><a href="Data.GS1.EPC.html#_graiCompanyPrefix"><span class="hs-identifier">_graiCompanyPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-302"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_graiAssetType"><a href="Data.GS1.EPC.html#_graiAssetType"><span class="hs-identifier">_graiAssetType</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#AssetType"><span class="hs-identifier hs-type">AssetType</span></a><span>
</span><a name="line-303"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_graiSerialNum"><a href="Data.GS1.EPC.html#_graiSerialNum"><span class="hs-identifier">_graiSerialNum</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-type">SerialNumber</span></a><span>
</span><a name="line-304"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-305"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span> </span><a href="Data.GS1.EPC.html#InstanceLabelEPC"><span class="hs-identifier hs-type">InstanceLabelEPC</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-308"></a><span>  </span><a name="local-8214565720323921189"><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier">uriPrefix</span></a></a><span> </span><a href="Data.GS1.EPC.html#GIAI"><span class="hs-identifier hs-var">GIAI</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:id:giai:&quot;</span><span>
</span><a name="line-309"></a><span>  </span><span class="hs-identifier">uriPrefix</span><span> </span><a href="Data.GS1.EPC.html#SSCC"><span class="hs-identifier hs-var">SSCC</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:id:sscc:&quot;</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-identifier">uriPrefix</span><span> </span><a href="Data.GS1.EPC.html#SGTIN"><span class="hs-identifier hs-var">SGTIN</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:id:sgtin:&quot;</span><span>
</span><a name="line-311"></a><span>  </span><span class="hs-identifier">uriPrefix</span><span> </span><a href="Data.GS1.EPC.html#GRAI"><span class="hs-identifier hs-var">GRAI</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:id:grai:&quot;</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span>  </span><a name="local-8214565720323921190"><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier">uriSuffix</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GIAI"><span class="hs-identifier hs-var">GIAI</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679156050"><a href="#local-6989586621679156050"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a name="local-6989586621679156051"><a href="#local-6989586621679156051"><span class="hs-identifier">sn</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679156050"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679156051"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">]</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SSCC"><span class="hs-identifier hs-var">SSCC</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679156052"><a href="#local-6989586621679156052"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a name="local-6989586621679156053"><a href="#local-6989586621679156053"><span class="hs-identifier">sn</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679156052"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679156053"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">]</span><span>
</span><a name="line-315"></a><span>  </span><span class="hs-comment">-- TODO: Should the second argument be used?</span><span>
</span><a name="line-316"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SGTIN"><span class="hs-identifier hs-var">SGTIN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679156054"><a href="#local-6989586621679156054"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-var">ItemReference</span></a><span> </span><a name="local-6989586621679156055"><a href="#local-6989586621679156055"><span class="hs-identifier">ir</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a name="local-6989586621679156056"><a href="#local-6989586621679156056"><span class="hs-identifier">sn</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-317"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679156054"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679156055"><span class="hs-identifier hs-var">ir</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679156056"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">]</span><span>
</span><a name="line-318"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GRAI"><span class="hs-identifier hs-var">GRAI</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679156057"><a href="#local-6989586621679156057"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#AssetType"><span class="hs-identifier hs-var">AssetType</span></a><span> </span><a name="local-6989586621679156058"><a href="#local-6989586621679156058"><span class="hs-identifier">aType</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a name="local-6989586621679156059"><a href="#local-6989586621679156059"><span class="hs-identifier">sn</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-319"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679156057"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679156058"><span class="hs-identifier hs-var">aType</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679156059"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">]</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span>  </span><a name="local-8214565720323921191"><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier">readURI</span></a></a><span> </span><a name="local-6989586621679156060"><a href="#local-6989586621679156060"><span class="hs-identifier">epcStr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#readURIInstanceLabelEPC"><span class="hs-identifier hs-var">readURIInstanceLabelEPC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><a href="#local-6989586621679156060"><span class="hs-identifier hs-var">epcStr</span></a><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-comment">-- | GS1_EPC_TDS_i1_11.pdf Page 28</span><span>
</span><a name="line-324"></a><span class="hs-identifier">sgtinPadLen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-325"></a><a name="sgtinPadLen"><a href="Data.GS1.EPC.html#sgtinPadLen"><span class="hs-identifier">sgtinPadLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">13</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-comment">-- | GS1_EPC_TDS_i1_11.pdf Page 29</span><span>
</span><a name="line-328"></a><span class="hs-identifier">ssccPadLen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-329"></a><a name="ssccPadLen"><a href="Data.GS1.EPC.html#ssccPadLen"><span class="hs-identifier">ssccPadLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">17</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-comment">-- TODO: This could be easily implemnted using proper parser combinators from attoparsec</span><span>
</span><a name="line-333"></a><span class="hs-comment">-- parsec, megaparsec or trifecta (parsers library)</span><span>
</span><a name="line-334"></a><span class="hs-identifier">readURIInstanceLabelEPC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#InstanceLabelEPC"><span class="hs-identifier hs-type">InstanceLabelEPC</span></a><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><a name="readURIInstanceLabelEPC"><a href="Data.GS1.EPC.html#readURIInstanceLabelEPC"><span class="hs-identifier">readURIInstanceLabelEPC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;urn&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;epc&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;id&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;giai&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679156061"><a href="#local-6989586621679156061"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-337"></a><span>  </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#GIAI"><span class="hs-identifier hs-var">GIAI</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679156062"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a href="#local-6989586621679156063"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">)</span><span>
</span><a name="line-338"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679156062"><a href="#local-6989586621679156062"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679156063"><a href="#local-6989586621679156063"><span class="hs-identifier">sn</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#getSuffixTokens"><span class="hs-identifier hs-var">getSuffixTokens</span></a><span> </span><a href="#local-6989586621679156061"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-identifier">readURIInstanceLabelEPC</span><span> </span><a name="local-6989586621679156064"><a href="#local-6989586621679156064"><span class="hs-identifier">xSnippet</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-string">&quot;urn&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;epc&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;id&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;sscc&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679156065"><a href="#local-6989586621679156065"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679156068"><span class="hs-identifier hs-var">isCorrectLen</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#SSCC"><span class="hs-identifier hs-var">SSCC</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679156066"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a href="#local-6989586621679156067"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidLength"><span class="hs-identifier hs-var">InvalidLength</span></a><span> </span><a href="#local-6989586621679156064"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-343"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-344"></a><span>        </span><span class="hs-special">[</span><a name="local-6989586621679156066"><a href="#local-6989586621679156066"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679156067"><a href="#local-6989586621679156067"><span class="hs-identifier">sn</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#getSuffixTokens"><span class="hs-identifier hs-var">getSuffixTokens</span></a><span> </span><a href="#local-6989586621679156065"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-345"></a><span>        </span><a name="local-6989586621679156068"><a href="#local-6989586621679156068"><span class="hs-identifier">isCorrectLen</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-346"></a><span>            </span><a href="Data.GS1.Utils.html#getTotalLength"><span class="hs-identifier hs-var">getTotalLength</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679156066"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679156067"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.GS1.EPC.html#ssccPadLen"><span class="hs-identifier hs-var">ssccPadLen</span></a><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-identifier">readURIInstanceLabelEPC</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;urn&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;epc&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;id&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;grai&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679156069"><a href="#local-6989586621679156069"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-349"></a><span>  </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#GRAI"><span class="hs-identifier hs-var">GRAI</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679156070"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#AssetType"><span class="hs-identifier hs-var">AssetType</span></a><span> </span><a href="#local-6989586621679156071"><span class="hs-identifier hs-var">assetType</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a href="#local-6989586621679156072"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679156070"><a href="#local-6989586621679156070"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679156071"><a href="#local-6989586621679156071"><span class="hs-identifier">assetType</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679156072"><a href="#local-6989586621679156072"><span class="hs-identifier">sn</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#getSuffixTokens"><span class="hs-identifier hs-var">getSuffixTokens</span></a><span> </span><a href="#local-6989586621679156069"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-identifier">readURIInstanceLabelEPC</span><span> </span><a name="local-6989586621679156073"><a href="#local-6989586621679156073"><span class="hs-identifier">xSnippet</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-string">&quot;urn&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;epc&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;id&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;sgtin&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679156074"><a href="#local-6989586621679156074"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679156078"><span class="hs-identifier hs-var">isCorrectLen</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-354"></a><span>      </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#SGTIN"><span class="hs-identifier hs-var">SGTIN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679156075"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#ItemReference"><span class="hs-identifier hs-var">ItemReference</span></a><span> </span><a href="#local-6989586621679156076"><span class="hs-identifier hs-var">ir</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a href="#local-6989586621679156077"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>                                         </span><span class="hs-comment">-- Nothing, for the moment</span><span>
</span><a name="line-356"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidLength"><span class="hs-identifier hs-var">InvalidLength</span></a><span> </span><a href="#local-6989586621679156073"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-357"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-358"></a><span>        </span><span class="hs-special">[</span><a name="local-6989586621679156075"><a href="#local-6989586621679156075"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679156076"><a href="#local-6989586621679156076"><span class="hs-identifier">ir</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679156077"><a href="#local-6989586621679156077"><span class="hs-identifier">sn</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#getSuffixTokens"><span class="hs-identifier hs-var">getSuffixTokens</span></a><span> </span><a href="#local-6989586621679156074"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-359"></a><span>        </span><a name="local-6989586621679156078"><a href="#local-6989586621679156078"><span class="hs-identifier">isCorrectLen</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-360"></a><span>            </span><a href="Data.GS1.Utils.html#getTotalLength"><span class="hs-identifier hs-var">getTotalLength</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679156075"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679156076"><span class="hs-identifier hs-var">ir</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.GS1.EPC.html#sgtinPadLen"><span class="hs-identifier hs-var">sgtinPadLen</span></a><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-identifier">readURIInstanceLabelEPC</span><span> </span><a name="local-6989586621679156079"><a href="#local-6989586621679156079"><span class="hs-identifier">xSnippet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><a href="#local-6989586621679156079"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679157649"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679157649"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679157649"><span class="hs-identifier hs-var">InstanceLabelEPC</span></a><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#InstanceLabelEPC"><span class="hs-identifier hs-type">InstanceLabelEPC</span></a><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-keyword">newtype</span><span> </span><a name="Lng"><a href="Data.GS1.EPC.html#Lng"><span class="hs-identifier">Lng</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Lng"><a href="Data.GS1.EPC.html#Lng"><span class="hs-identifier">Lng</span></a></a><span> </span><span class="hs-special">{</span><a name="unLng"><a href="Data.GS1.EPC.html#unLng"><span class="hs-identifier">unLng</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">}</span><span>
</span><a name="line-369"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span class="hs-keyword">newtype</span><span> </span><a name="Lat"><a href="Data.GS1.EPC.html#Lat"><span class="hs-identifier">Lat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Lat"><a href="Data.GS1.EPC.html#Lat"><span class="hs-identifier">Lat</span></a></a><span> </span><span class="hs-special">{</span><a name="unLat"><a href="Data.GS1.EPC.html#unLat"><span class="hs-identifier">unLat</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">}</span><span>
</span><a name="line-371"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span class="hs-keyword">newtype</span><span> </span><a name="LocationReference"><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier">LocationReference</span></a></a><span>
</span><a name="line-373"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LocationReference"><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier">LocationReference</span></a></a><span>
</span><a name="line-374"></a><span>  </span><span class="hs-special">{</span><span>
</span><a name="line-375"></a><span>    </span><a name="_locationRefVal"><a href="Data.GS1.EPC.html#_locationRefVal"><span class="hs-identifier">_locationRefVal</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-376"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-377"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679159049"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679159049"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679159049"><span class="hs-identifier hs-var">LocationReference</span></a><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-comment">-- | EPCIS_Guideline.pdf Release 1.2 Ratified Feb 2017 - page 35 4.7.2</span><span>
</span><a name="line-381"></a><span class="hs-comment">-- In EPCIS, the GLN+extension is represented as a Uniform Resource Identifier</span><span>
</span><a name="line-382"></a><span class="hs-comment">-- (URI) according to the EPC Tag Data Standard. The specific type of URI is</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- called an SGLN, which is capable of representing either a</span><span>
</span><a name="line-384"></a><span class="hs-comment">-- GLN+extension or a GLN without extension. The SGLN for</span><span>
</span><a name="line-385"></a><span class="hs-comment">-- GLN 0614141111114 and extension 987 looks like this:</span><span>
</span><a name="line-386"></a><span class="hs-comment">-- urn:epc:id:sgln:0614141.11111.978</span><span>
</span><a name="line-387"></a><span class="hs-keyword">data</span><span> </span><a name="LocationEPC"><a href="Data.GS1.EPC.html#LocationEPC"><span class="hs-identifier">LocationEPC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SGLN"><a href="Data.GS1.EPC.html#SGLN"><span class="hs-identifier">SGLN</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-388"></a><span>    </span><a name="_sglnCompanyPrefix"><a href="Data.GS1.EPC.html#_sglnCompanyPrefix"><span class="hs-identifier">_sglnCompanyPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-389"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_locationRef"><a href="Data.GS1.EPC.html#_locationRef"><span class="hs-identifier">_locationRef</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier hs-type">LocationReference</span></a><span>
</span><a name="line-390"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_sglnExt"><a href="Data.GS1.EPC.html#_sglnExt"><span class="hs-identifier">_sglnExt</span></a></a><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#SGLNExtension"><span class="hs-identifier hs-type">SGLNExtension</span></a><span>
</span><a name="line-391"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-392"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-393"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679159512"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679159512"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679159512"><span class="hs-identifier hs-var">LocationEPC</span></a><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier hs-type">LocationReference</span></a><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Hashable</span><span> </span><a href="Data.GS1.EPC.html#LocationEPC"><span class="hs-identifier hs-type">LocationEPC</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-398"></a><span>  </span><a name="local-8214565720323799973"><span class="hs-identifier">hashWithSalt</span></a><span> </span><a name="local-6989586621679159529"><a href="#local-6989586621679159529"><span class="hs-identifier">salt</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SGLN"><span class="hs-identifier hs-var">SGLN</span></a><span> </span><a name="local-6989586621679159530"><a href="#local-6989586621679159530"><span class="hs-identifier">pfx</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hashWithSalt</span><span> </span><a href="#local-6989586621679159529"><span class="hs-identifier hs-var">salt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">unGS1CompanyPrefix</span><span> </span><a href="#local-6989586621679159530"><span class="hs-identifier hs-var">pfx</span></a><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span> </span><a href="Data.GS1.EPC.html#LocationEPC"><span class="hs-identifier hs-type">LocationEPC</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-401"></a><span>  </span><a name="local-8214565720323921189"><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier">uriPrefix</span></a></a><span> </span><a href="Data.GS1.EPC.html#SGLN"><span class="hs-identifier hs-var">SGLN</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:id:sgln:&quot;</span><span>
</span><a name="line-402"></a><span>  </span><a name="local-8214565720323921190"><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier">uriSuffix</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SGLN"><span class="hs-identifier hs-var">SGLN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679159523"><a href="#local-6989586621679159523"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier hs-var">LocationReference</span></a><span> </span><a name="local-6989586621679159524"><a href="#local-6989586621679159524"><span class="hs-identifier">loc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SGLNExtension"><span class="hs-identifier hs-var">SGLNExtension</span></a><span> </span><a name="local-6989586621679159525"><a href="#local-6989586621679159525"><span class="hs-identifier">ext</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-403"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679159523"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679159524"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679159525"><span class="hs-identifier hs-var">ext</span></a><span class="hs-special">]</span><span>
</span><a name="line-404"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SGLN"><span class="hs-identifier hs-var">SGLN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679159526"><a href="#local-6989586621679159526"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier hs-var">LocationReference</span></a><span> </span><a name="local-6989586621679159527"><a href="#local-6989586621679159527"><span class="hs-identifier">loc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679159526"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679159527"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">]</span><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><span>  </span><a name="local-8214565720323921191"><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier">readURI</span></a></a><span> </span><a name="local-6989586621679159528"><a href="#local-6989586621679159528"><span class="hs-identifier">epcStr</span></a></a><span>
</span><a name="line-407"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="Data.GS1.EPC.html#isLocationEPC"><span class="hs-identifier hs-var">isLocationEPC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><a href="#local-6989586621679159528"><span class="hs-identifier hs-var">epcStr</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-408"></a><span>      </span><a href="Data.GS1.EPC.html#readURILocationEPC"><span class="hs-identifier hs-var">readURILocationEPC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><a href="#local-6989586621679159528"><span class="hs-identifier hs-var">epcStr</span></a><span> </span><span class="hs-comment">-- TODO: Last is unsafe</span><span>
</span><a name="line-409"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-var">XMLSnippet</span></a><span> </span><a href="#local-6989586621679159528"><span class="hs-identifier hs-var">epcStr</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>
</span><a name="line-411"></a><span class="hs-identifier">isLocationEPC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-412"></a><a name="isLocationEPC"><a href="Data.GS1.EPC.html#isLocationEPC"><span class="hs-identifier">isLocationEPC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;urn&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;epc&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;id&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-string">&quot;sgln&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-413"></a><span class="hs-identifier">isLocationEPC</span><span> </span><span class="hs-identifier">_</span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-comment">-- | GS1_EPC_TDS_i1_11.pdf Page 29</span><span>
</span><a name="line-416"></a><span class="hs-identifier">sglnPadLen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-417"></a><a name="sglnPadLen"><a href="Data.GS1.EPC.html#sglnPadLen"><span class="hs-identifier">sglnPadLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">12</span><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-identifier">getExt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#SGLNExtension"><span class="hs-identifier hs-type">SGLNExtension</span></a><span>
</span><a name="line-420"></a><a name="getExt"><a href="Data.GS1.EPC.html#getExt"><span class="hs-identifier">getExt</span></a></a><span> </span><span class="hs-string">&quot;0&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-421"></a><span class="hs-identifier">getExt</span><span> </span><a name="local-6989586621679159531"><a href="#local-6989586621679159531"><span class="hs-identifier">s</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SGLNExtension"><span class="hs-identifier hs-var">SGLNExtension</span></a><span> </span><a href="#local-6989586621679159531"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>
</span><a name="line-423"></a><span class="hs-identifier">readURILocationEPC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#LocationEPC"><span class="hs-identifier hs-type">LocationEPC</span></a><span>
</span><a name="line-424"></a><span class="hs-comment">-- without extension</span><span>
</span><a name="line-425"></a><a name="readURILocationEPC"><a href="Data.GS1.EPC.html#readURILocationEPC"><span class="hs-identifier">readURILocationEPC</span></a></a><span> </span><a name="local-6989586621679159532"><a href="#local-6989586621679159532"><span class="hs-identifier">xSnippet</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><a name="local-6989586621679159533"><a href="#local-6989586621679159533"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679159534"><a href="#local-6989586621679159534"><span class="hs-identifier">loc</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-426"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679159535"><span class="hs-identifier hs-var">isCorrectLen</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-427"></a><span>      </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#SGLN"><span class="hs-identifier hs-var">SGLN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679159533"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier hs-var">LocationReference</span></a><span> </span><a href="#local-6989586621679159534"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-428"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidLength"><span class="hs-identifier hs-var">InvalidLength</span></a><span> </span><a href="#local-6989586621679159532"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-429"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-430"></a><span>      </span><a name="local-6989586621679159535"><a href="#local-6989586621679159535"><span class="hs-identifier">isCorrectLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#getTotalLength"><span class="hs-identifier hs-var">getTotalLength</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679159533"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679159534"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.GS1.EPC.html#sglnPadLen"><span class="hs-identifier hs-var">sglnPadLen</span></a><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span class="hs-comment">-- with extension</span><span>
</span><a name="line-433"></a><span class="hs-identifier">readURILocationEPC</span><span> </span><a name="local-6989586621679159536"><a href="#local-6989586621679159536"><span class="hs-identifier">xSnippet</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">[</span><a name="local-6989586621679159537"><a href="#local-6989586621679159537"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679159538"><a href="#local-6989586621679159538"><span class="hs-identifier">loc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679159539"><a href="#local-6989586621679159539"><span class="hs-identifier">extNum</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679159540"><span class="hs-identifier hs-var">isCorrectLen</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-435"></a><span>      </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-436"></a><span>        </span><a href="Data.GS1.EPC.html#SGLN"><span class="hs-identifier hs-var">SGLN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679159537"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#LocationReference"><span class="hs-identifier hs-var">LocationReference</span></a><span> </span><a href="#local-6989586621679159538"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#getExt"><span class="hs-identifier hs-var">getExt</span></a><span> </span><a href="#local-6989586621679159539"><span class="hs-identifier hs-var">extNum</span></a><span class="hs-special">)</span><span>
</span><a name="line-437"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidLength"><span class="hs-identifier hs-var">InvalidLength</span></a><span> </span><a href="#local-6989586621679159536"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-438"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-439"></a><span>      </span><a name="local-6989586621679159540"><a href="#local-6989586621679159540"><span class="hs-identifier">isCorrectLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#getTotalLength"><span class="hs-identifier hs-var">getTotalLength</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679159537"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679159538"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.GS1.EPC.html#sglnPadLen"><span class="hs-identifier hs-var">sglnPadLen</span></a><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-identifier">readURILocationEPC</span><span> </span><a name="local-6989586621679159541"><a href="#local-6989586621679159541"><span class="hs-identifier">xSnippet</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><a href="#local-6989586621679159541"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-442"></a><span class="hs-comment">-- error condition / invalid input</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#LocationEPC"><span class="hs-identifier hs-type">LocationEPC</span></a><span>
</span><a name="line-445"></a><span class="hs-comment">-- | EPCIS_Guideline.pdf Release 1.2 Ratified Feb 2017 - page 19</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- Source List and Destination List: is used to provide additional business context</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- when an EPCIS event is part of a business transfer of ownership, responsibility</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- or custody. As with business transactions, a source or destination is identified by</span><span>
</span><a name="line-449"></a><span class="hs-comment">-- a pair of identifiers: the type of the source or destination and an identifier</span><span>
</span><a name="line-450"></a><span class="hs-comment">-- of the source or destination of that type. The GS1 CBV (section 7.4.2)</span><span>
</span><a name="line-451"></a><span class="hs-comment">-- distinguishes three standard source/destination types: &#8220;owning_party&#8221;,</span><span>
</span><a name="line-452"></a><span class="hs-comment">-- &#8220;possessing_party&#8221;, &#8220;location&#8221;.</span><span>
</span><a name="line-453"></a><span class="hs-keyword">data</span><span> </span><a name="SourceDestType"><a href="Data.GS1.EPC.html#SourceDestType"><span class="hs-identifier">SourceDestType</span></a></a><span>
</span><a name="line-454"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="SDOwningParty"><a href="Data.GS1.EPC.html#SDOwningParty"><span class="hs-identifier">SDOwningParty</span></a></a><span>
</span><a name="line-455"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SDPossessingParty"><a href="Data.GS1.EPC.html#SDPossessingParty"><span class="hs-identifier">SDPossessingParty</span></a></a><span>
</span><a name="line-456"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SDLocation"><a href="Data.GS1.EPC.html#SDLocation"><span class="hs-identifier">SDLocation</span></a></a><span>
</span><a name="line-457"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-458"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679160099"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679160099"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679160099"><span class="hs-identifier hs-var">SourceDestType</span></a><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#SourceDestType"><span class="hs-identifier hs-type">SourceDestType</span></a><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span> </span><a href="Data.GS1.EPC.html#SourceDestType"><span class="hs-identifier hs-type">SourceDestType</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-462"></a><span>  </span><a name="local-8214565720323921189"><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier">uriPrefix</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epcglobal:cbv:sdt:&quot;</span><span>
</span><a name="line-463"></a><span>  </span><a name="local-8214565720323921190"><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier">uriSuffix</span></a></a><span> </span><a href="Data.GS1.EPC.html#SDOwningParty"><span class="hs-identifier hs-var">SDOwningParty</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;owning_party&quot;</span><span>
</span><a name="line-464"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span> </span><a href="Data.GS1.EPC.html#SDPossessingParty"><span class="hs-identifier hs-var">SDPossessingParty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;possessing_party&quot;</span><span>
</span><a name="line-465"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span> </span><a href="Data.GS1.EPC.html#SDLocation"><span class="hs-identifier hs-var">SDLocation</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;location&quot;</span><span>
</span><a name="line-466"></a><span>  </span><a name="local-8214565720323921191"><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier">readURI</span></a></a><span> </span><a name="local-6989586621679160126"><a href="#local-6989586621679160126"><span class="hs-identifier">epc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#readSrcDestURI"><span class="hs-identifier hs-var">readSrcDestURI</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><a href="#local-6989586621679160126"><span class="hs-identifier hs-var">epc</span></a><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span>
</span><a name="line-469"></a><span class="hs-identifier">readSrcDestURI</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#SourceDestType"><span class="hs-identifier hs-type">SourceDestType</span></a><span>
</span><a name="line-470"></a><a name="readSrcDestURI"><a href="Data.GS1.EPC.html#readSrcDestURI"><span class="hs-identifier">readSrcDestURI</span></a></a><span> </span><span class="hs-string">&quot;owning_party&quot;</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="Data.GS1.EPC.html#SDOwningParty"><span class="hs-identifier hs-var">SDOwningParty</span></a><span>
</span><a name="line-471"></a><span class="hs-identifier">readSrcDestURI</span><span> </span><span class="hs-string">&quot;possessing_party&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="Data.GS1.EPC.html#SDPossessingParty"><span class="hs-identifier hs-var">SDPossessingParty</span></a><span>
</span><a name="line-472"></a><span class="hs-identifier">readSrcDestURI</span><span> </span><span class="hs-string">&quot;location&quot;</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="Data.GS1.EPC.html#SDLocation"><span class="hs-identifier hs-var">SDLocation</span></a><span>
</span><a name="line-473"></a><span class="hs-identifier">readSrcDestURI</span><span> </span><a name="local-6989586621679160127"><a href="#local-6989586621679160127"><span class="hs-identifier">errTxt</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-var">XMLSnippet</span></a><span> </span><a href="#local-6989586621679160127"><span class="hs-identifier hs-var">errTxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span class="hs-comment">-- https://github.csiro.au/Blockchain/GS1Combinators/blob/master/doc/GS1_EPC_TDS_i1_11.pdf</span><span>
</span><a name="line-476"></a><span class="hs-keyword">newtype</span><span> </span><a name="DocumentType"><a href="Data.GS1.EPC.html#DocumentType"><span class="hs-identifier">DocumentType</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a name="DocumentType"><a href="Data.GS1.EPC.html#DocumentType"><span class="hs-identifier">DocumentType</span></a></a><span> </span><span class="hs-special">{</span><a name="unDocumentType"><a href="Data.GS1.EPC.html#unDocumentType"><span class="hs-identifier">unDocumentType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-477"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-478"></a><span class="hs-keyword">newtype</span><span> </span><a name="ServiceReference"><a href="Data.GS1.EPC.html#ServiceReference"><span class="hs-identifier">ServiceReference</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ServiceReference"><a href="Data.GS1.EPC.html#ServiceReference"><span class="hs-identifier">ServiceReference</span></a></a><span> </span><span class="hs-special">{</span><a name="unServiceReference"><a href="Data.GS1.EPC.html#unServiceReference"><span class="hs-identifier">unServiceReference</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-479"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#DocumentType"><span class="hs-identifier hs-type">DocumentType</span></a><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span class="hs-comment">--TODO: Implement URI instances for GCN and CPID</span><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span class="hs-comment">-- |  Other GS1 object identifiers include GDTI for documents,</span><span>
</span><a name="line-486"></a><span class="hs-comment">-- GIAI for individual assets, GRAI for returnable assets,</span><span>
</span><a name="line-487"></a><span class="hs-comment">-- GSRN for services, GCN for coupons, and CPID for components or parts.</span><span>
</span><a name="line-488"></a><span class="hs-keyword">data</span><span> </span><a name="BusinessTransactionEPC"><a href="Data.GS1.EPC.html#BusinessTransactionEPC"><span class="hs-identifier">BusinessTransactionEPC</span></a></a><span>
</span><a name="line-489"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="GDTI"><a href="Data.GS1.EPC.html#GDTI"><span class="hs-identifier">GDTI</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-490"></a><span>    </span><a name="_gdtiCompanyPrefix"><a href="Data.GS1.EPC.html#_gdtiCompanyPrefix"><span class="hs-identifier">_gdtiCompanyPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-491"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_gdtiDocType"><a href="Data.GS1.EPC.html#_gdtiDocType"><span class="hs-identifier">_gdtiDocType</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#DocumentType"><span class="hs-identifier hs-type">DocumentType</span></a><span>
</span><a name="line-492"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_gdtiSerialNum"><a href="Data.GS1.EPC.html#_gdtiSerialNum"><span class="hs-identifier">_gdtiSerialNum</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-type">SerialNumber</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-493"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GSRN"><a href="Data.GS1.EPC.html#GSRN"><span class="hs-identifier">GSRN</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-494"></a><span>    </span><a name="_gsrnCompanyPrefix"><a href="Data.GS1.EPC.html#_gsrnCompanyPrefix"><span class="hs-identifier">_gsrnCompanyPrefix</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-type">GS1CompanyPrefix</span></a><span>
</span><a name="line-495"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_gsrnSerialRef"><a href="Data.GS1.EPC.html#_gsrnSerialRef"><span class="hs-identifier">_gsrnSerialRef</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#SerialReference"><span class="hs-identifier hs-type">SerialReference</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-496"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-497"></a><span>
</span><a name="line-498"></a><span class="hs-comment">-- urn:epc:id:gdti:CompanyPrefix.DocumentType.SerialNumber</span><span>
</span><a name="line-499"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span> </span><a href="Data.GS1.EPC.html#BusinessTransactionEPC"><span class="hs-identifier hs-type">BusinessTransactionEPC</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-500"></a><span>  </span><a name="local-8214565720323921189"><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier">uriPrefix</span></a></a><span> </span><a href="Data.GS1.EPC.html#GDTI"><span class="hs-identifier hs-var">GDTI</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:id:gsrn:&quot;</span><span>
</span><a name="line-501"></a><span>  </span><span class="hs-identifier">uriPrefix</span><span> </span><a href="Data.GS1.EPC.html#GSRN"><span class="hs-identifier hs-var">GSRN</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epc:id:gsrn:&quot;</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span>  </span><a name="local-8214565720323921190"><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier">uriSuffix</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GDTI"><span class="hs-identifier hs-var">GDTI</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679160120"><a href="#local-6989586621679160120"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#DocumentType"><span class="hs-identifier hs-var">DocumentType</span></a><span> </span><a name="local-6989586621679160121"><a href="#local-6989586621679160121"><span class="hs-identifier">documentType</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a name="local-6989586621679160122"><a href="#local-6989586621679160122"><span class="hs-identifier">sn</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-504"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679160120"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679160121"><span class="hs-identifier hs-var">documentType</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679160122"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">]</span><span>
</span><a name="line-505"></a><span>  </span><span class="hs-identifier">uriSuffix</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GSRN"><span class="hs-identifier hs-var">GSRN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a name="local-6989586621679160123"><a href="#local-6989586621679160123"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialReference"><span class="hs-identifier hs-var">SerialReference</span></a><span> </span><a name="local-6989586621679160124"><a href="#local-6989586621679160124"><span class="hs-identifier">sr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679160123"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679160124"><span class="hs-identifier hs-var">sr</span></a><span class="hs-special">]</span><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span>  </span><a name="local-8214565720323921191"><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier">readURI</span></a></a><span> </span><a name="local-6989586621679160125"><a href="#local-6989586621679160125"><span class="hs-identifier">epcStr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#readURIBusinessTransactionEPC"><span class="hs-identifier hs-var">readURIBusinessTransactionEPC</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-508"></a><span>                      </span><a href="Data.GS1.EPC.html#getSuffixTokens"><span class="hs-identifier hs-var">getSuffixTokens</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><a href="#local-6989586621679160125"><span class="hs-identifier hs-var">epcStr</span></a><span class="hs-special">]</span><span>
</span><a name="line-509"></a><span class="hs-comment">--                    Getting the uri body out of the string</span><span>
</span><a name="line-510"></a><span>
</span><a name="line-511"></a><span>
</span><a name="line-512"></a><span class="hs-comment">-- the length of the arguments should equal to the following,</span><span>
</span><a name="line-513"></a><span class="hs-comment">-- according to the spec</span><span>
</span><a name="line-514"></a><span class="hs-comment">-- used for the purposes of validation</span><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span class="hs-comment">-- GS1_EPC_TDS_i1_11.pdf Page 31</span><span>
</span><a name="line-517"></a><span class="hs-identifier">gsrnPadLen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-518"></a><a name="gsrnPadLen"><a href="Data.GS1.EPC.html#gsrnPadLen"><span class="hs-identifier">gsrnPadLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">17</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-comment">-- GS1_EPC_TDS_i1_11.pdf Page 32</span><span>
</span><a name="line-521"></a><span class="hs-identifier">gdtiPadLen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-522"></a><a name="gdtiPadLen"><a href="Data.GS1.EPC.html#gdtiPadLen"><span class="hs-identifier">gdtiPadLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">12</span><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span class="hs-identifier">readURIBusinessTransactionEPC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-525"></a><span>                                  </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#BusinessTransactionEPC"><span class="hs-identifier hs-type">BusinessTransactionEPC</span></a><span>
</span><a name="line-526"></a><a name="readURIBusinessTransactionEPC"><a href="Data.GS1.EPC.html#readURIBusinessTransactionEPC"><span class="hs-identifier">readURIBusinessTransactionEPC</span></a></a><span> </span><a name="local-6989586621679160128"><a href="#local-6989586621679160128"><span class="hs-identifier">xSnippet</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">[</span><a name="local-6989586621679160129"><a href="#local-6989586621679160129"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679160130"><a href="#local-6989586621679160130"><span class="hs-identifier">sref</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-527"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679160131"><span class="hs-identifier hs-var">isCorrectLen</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#GSRN"><span class="hs-identifier hs-var">GSRN</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679160129"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialReference"><span class="hs-identifier hs-var">SerialReference</span></a><span> </span><a href="#local-6989586621679160130"><span class="hs-identifier hs-var">sref</span></a><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidLength"><span class="hs-identifier hs-var">InvalidLength</span></a><span> </span><a href="#local-6989586621679160128"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-529"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-530"></a><span>    </span><a name="local-6989586621679160131"><a href="#local-6989586621679160131"><span class="hs-identifier">isCorrectLen</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-531"></a><span>        </span><a href="Data.GS1.Utils.html#getTotalLength"><span class="hs-identifier hs-var">getTotalLength</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679160129"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679160130"><span class="hs-identifier hs-var">sref</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.GS1.EPC.html#gsrnPadLen"><span class="hs-identifier hs-var">gsrnPadLen</span></a><span>
</span><a name="line-532"></a><span class="hs-identifier">readURIBusinessTransactionEPC</span><span> </span><a name="local-6989586621679160132"><a href="#local-6989586621679160132"><span class="hs-identifier">xSnippet</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">[</span><a name="local-6989586621679160133"><a href="#local-6989586621679160133"><span class="hs-identifier">pfix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679160134"><a href="#local-6989586621679160134"><span class="hs-identifier">docType</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679160135"><a href="#local-6989586621679160135"><span class="hs-identifier">sn</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679160136"><span class="hs-identifier hs-var">isCorrectLen</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#GDTI"><span class="hs-identifier hs-var">GDTI</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#GS1CompanyPrefix"><span class="hs-identifier hs-var">GS1CompanyPrefix</span></a><span> </span><a href="#local-6989586621679160133"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#DocumentType"><span class="hs-identifier hs-var">DocumentType</span></a><span> </span><a href="#local-6989586621679160134"><span class="hs-identifier hs-var">docType</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#SerialNumber"><span class="hs-identifier hs-var">SerialNumber</span></a><span> </span><a href="#local-6989586621679160135"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- BUG!</span><span>
</span><a name="line-534"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidLength"><span class="hs-identifier hs-var">InvalidLength</span></a><span> </span><a href="#local-6989586621679160132"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-535"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-536"></a><span>    </span><a name="local-6989586621679160136"><a href="#local-6989586621679160136"><span class="hs-identifier">isCorrectLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#getTotalLength"><span class="hs-identifier hs-var">getTotalLength</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679160133"><span class="hs-identifier hs-var">pfix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679160134"><span class="hs-identifier hs-var">docType</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679160135"><span class="hs-identifier hs-var">sn</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.GS1.EPC.html#gdtiPadLen"><span class="hs-identifier hs-var">gdtiPadLen</span></a><span>
</span><a name="line-537"></a><span class="hs-identifier">readURIBusinessTransactionEPC</span><span> </span><a name="local-6989586621679160137"><a href="#local-6989586621679160137"><span class="hs-identifier">xSnippet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.EPC.html#makeErrorType"><span class="hs-identifier hs-var">makeErrorType</span></a><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><a href="#local-6989586621679160137"><span class="hs-identifier hs-var">xSnippet</span></a><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679161761"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679161761"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679161761"><span class="hs-identifier hs-var">BusinessTransactionEPC</span></a><span class="hs-special">)</span><span>
</span><a name="line-540"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#BusinessTransactionEPC"><span class="hs-identifier hs-type">BusinessTransactionEPC</span></a><span>
</span><a name="line-541"></a><span>
</span><a name="line-542"></a><span class="hs-keyword">data</span><span> </span><a name="LocationError"><a href="Data.GS1.EPC.html#LocationError"><span class="hs-identifier">LocationError</span></a></a><span>
</span><a name="line-543"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="IllegalGLNFormat"><a href="Data.GS1.EPC.html#IllegalGLNFormat"><span class="hs-identifier">IllegalGLNFormat</span></a></a><span>
</span><a name="line-544"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InvalidChecksum"><a href="Data.GS1.EPC.html#InvalidChecksum"><span class="hs-identifier">InvalidChecksum</span></a></a><span>
</span><a name="line-545"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span class="hs-comment">-- | CBV-Standard-1-2-r-2016-09-29.pdf Page 17</span><span>
</span><a name="line-548"></a><span class="hs-keyword">data</span><span> </span><a name="BizStep"><a href="Data.GS1.EPC.html#BizStep"><span class="hs-identifier">BizStep</span></a></a><span>
</span><a name="line-549"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Accepting"><a href="Data.GS1.EPC.html#Accepting"><span class="hs-identifier">Accepting</span></a></a><span>
</span><a name="line-550"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Arriving"><a href="Data.GS1.EPC.html#Arriving"><span class="hs-identifier">Arriving</span></a></a><span>
</span><a name="line-551"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Assembling"><a href="Data.GS1.EPC.html#Assembling"><span class="hs-identifier">Assembling</span></a></a><span>
</span><a name="line-552"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Collecting"><a href="Data.GS1.EPC.html#Collecting"><span class="hs-identifier">Collecting</span></a></a><span>
</span><a name="line-553"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Commissioning"><a href="Data.GS1.EPC.html#Commissioning"><span class="hs-identifier">Commissioning</span></a></a><span>
</span><a name="line-554"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Consigning"><a href="Data.GS1.EPC.html#Consigning"><span class="hs-identifier">Consigning</span></a></a><span>
</span><a name="line-555"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CreatingClassInstance"><a href="Data.GS1.EPC.html#CreatingClassInstance"><span class="hs-identifier">CreatingClassInstance</span></a></a><span>
</span><a name="line-556"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CycleCounting"><a href="Data.GS1.EPC.html#CycleCounting"><span class="hs-identifier">CycleCounting</span></a></a><span>
</span><a name="line-557"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Decommissioning"><a href="Data.GS1.EPC.html#Decommissioning"><span class="hs-identifier">Decommissioning</span></a></a><span>
</span><a name="line-558"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Departing"><a href="Data.GS1.EPC.html#Departing"><span class="hs-identifier">Departing</span></a></a><span>
</span><a name="line-559"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Destroying"><a href="Data.GS1.EPC.html#Destroying"><span class="hs-identifier">Destroying</span></a></a><span>
</span><a name="line-560"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Disassembling"><a href="Data.GS1.EPC.html#Disassembling"><span class="hs-identifier">Disassembling</span></a></a><span>
</span><a name="line-561"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Dispensing"><a href="Data.GS1.EPC.html#Dispensing"><span class="hs-identifier">Dispensing</span></a></a><span>
</span><a name="line-562"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Encoding"><a href="Data.GS1.EPC.html#Encoding"><span class="hs-identifier">Encoding</span></a></a><span>
</span><a name="line-563"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EnteringExiting"><a href="Data.GS1.EPC.html#EnteringExiting"><span class="hs-identifier">EnteringExiting</span></a></a><span>
</span><a name="line-564"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Holding"><a href="Data.GS1.EPC.html#Holding"><span class="hs-identifier">Holding</span></a></a><span>
</span><a name="line-565"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Inspecting"><a href="Data.GS1.EPC.html#Inspecting"><span class="hs-identifier">Inspecting</span></a></a><span>
</span><a name="line-566"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Installing"><a href="Data.GS1.EPC.html#Installing"><span class="hs-identifier">Installing</span></a></a><span>
</span><a name="line-567"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Killing"><a href="Data.GS1.EPC.html#Killing"><span class="hs-identifier">Killing</span></a></a><span>
</span><a name="line-568"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Loading"><a href="Data.GS1.EPC.html#Loading"><span class="hs-identifier">Loading</span></a></a><span>
</span><a name="line-569"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Other"><a href="Data.GS1.EPC.html#Other"><span class="hs-identifier">Other</span></a></a><span>
</span><a name="line-570"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Packing"><a href="Data.GS1.EPC.html#Packing"><span class="hs-identifier">Packing</span></a></a><span>
</span><a name="line-571"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Picking"><a href="Data.GS1.EPC.html#Picking"><span class="hs-identifier">Picking</span></a></a><span>
</span><a name="line-572"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Receiving"><a href="Data.GS1.EPC.html#Receiving"><span class="hs-identifier">Receiving</span></a></a><span>
</span><a name="line-573"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Removing"><a href="Data.GS1.EPC.html#Removing"><span class="hs-identifier">Removing</span></a></a><span>
</span><a name="line-574"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Repackaging"><a href="Data.GS1.EPC.html#Repackaging"><span class="hs-identifier">Repackaging</span></a></a><span>
</span><a name="line-575"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Repairing"><a href="Data.GS1.EPC.html#Repairing"><span class="hs-identifier">Repairing</span></a></a><span>
</span><a name="line-576"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Replacing"><a href="Data.GS1.EPC.html#Replacing"><span class="hs-identifier">Replacing</span></a></a><span>
</span><a name="line-577"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Reserving"><a href="Data.GS1.EPC.html#Reserving"><span class="hs-identifier">Reserving</span></a></a><span>
</span><a name="line-578"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RetailSelling"><a href="Data.GS1.EPC.html#RetailSelling"><span class="hs-identifier">RetailSelling</span></a></a><span>
</span><a name="line-579"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Shipping"><a href="Data.GS1.EPC.html#Shipping"><span class="hs-identifier">Shipping</span></a></a><span>
</span><a name="line-580"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StagingOutbound"><a href="Data.GS1.EPC.html#StagingOutbound"><span class="hs-identifier">StagingOutbound</span></a></a><span>
</span><a name="line-581"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StockTaking"><a href="Data.GS1.EPC.html#StockTaking"><span class="hs-identifier">StockTaking</span></a></a><span>
</span><a name="line-582"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Stocking"><a href="Data.GS1.EPC.html#Stocking"><span class="hs-identifier">Stocking</span></a></a><span>
</span><a name="line-583"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Storing"><a href="Data.GS1.EPC.html#Storing"><span class="hs-identifier">Storing</span></a></a><span>
</span><a name="line-584"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Transporting"><a href="Data.GS1.EPC.html#Transporting"><span class="hs-identifier">Transporting</span></a></a><span>
</span><a name="line-585"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Unloading"><a href="Data.GS1.EPC.html#Unloading"><span class="hs-identifier">Unloading</span></a></a><span>
</span><a name="line-586"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VoidShipping"><a href="Data.GS1.EPC.html#VoidShipping"><span class="hs-identifier">VoidShipping</span></a></a><span>
</span><a name="line-587"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-588"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679164888"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679164888"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679164888"><span class="hs-identifier hs-var">BizStep</span></a><span class="hs-special">)</span><span>
</span><a name="line-589"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#BizStep"><span class="hs-identifier hs-type">BizStep</span></a><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-identifier">ppBizStep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#BizStep"><span class="hs-identifier hs-type">BizStep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-592"></a><a name="ppBizStep"><a href="Data.GS1.EPC.html#ppBizStep"><span class="hs-identifier">ppBizStep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#revertCamelCase"><span class="hs-identifier hs-var">revertCamelCase</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span>
</span><a name="line-593"></a><span>
</span><a name="line-594"></a><span class="hs-identifier">readURIBizStep</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#BizStep"><span class="hs-identifier hs-type">BizStep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#BizStep"><span class="hs-identifier hs-type">BizStep</span></a><span>
</span><a name="line-595"></a><a name="readURIBizStep"><a href="Data.GS1.EPC.html#readURIBizStep"><span class="hs-identifier">readURIBizStep</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>        </span><a name="local-6989586621679164908"><a href="#local-6989586621679164908"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-var">XMLSnippet</span></a><span> </span><a href="#local-6989586621679164908"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-596"></a><span class="hs-identifier">readURIBizStep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679164909"><a href="#local-6989586621679164909"><span class="hs-identifier">bizstep</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679164909"><span class="hs-identifier hs-var">bizstep</span></a><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span class="hs-comment">-- CBV-Standard-1-2-r-2016-09-29.pdf page 16</span><span>
</span><a name="line-599"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span> </span><a href="Data.GS1.EPC.html#BizStep"><span class="hs-identifier hs-type">BizStep</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-600"></a><span>  </span><a name="local-8214565720323921189"><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier">uriPrefix</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epcglobal:cbv:bizstep:&quot;</span><span>
</span><a name="line-601"></a><span>  </span><a name="local-8214565720323921190"><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier">uriSuffix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.GS1.EPC.html#ppBizStep"><span class="hs-identifier hs-var">ppBizStep</span></a><span>
</span><a name="line-602"></a><span>  </span><a name="local-8214565720323921191"><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier">readURI</span></a></a><span>  </span><a name="local-6989586621679164906"><a href="#local-6989586621679164906"><span class="hs-identifier">s</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679164907"><a href="#local-6989586621679164907"><span class="hs-identifier">pURI</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a><span> </span><a href="#local-6989586621679164906"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-string">&quot;urn:epcglobal:cbv:bizstep&quot;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#BizStep"><span class="hs-identifier hs-type">BizStep</span></a><span>
</span><a name="line-603"></a><span>                   </span><span class="hs-keyword">in</span><span> </span><a href="Data.GS1.EPC.html#readURIBizStep"><span class="hs-identifier hs-var">readURIBizStep</span></a><span> </span><a href="#local-6989586621679164907"><span class="hs-identifier hs-var">pURI</span></a><span> </span><a href="#local-6989586621679164906"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-604"></a><span>
</span><a name="line-605"></a><span class="hs-comment">{-
  Example:

  &lt;bizTransactionList&gt;
    &lt;bizTransaction type=&quot;urn:epcglobal:cbv:btt:po&quot;&gt;
      http://transaction.acme.com/po/12345678
    &lt;/bizTransaction&gt;
  &lt;/bizTransactionList&gt;

-}</span><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-keyword">newtype</span><span> </span><a name="BizTransactionId"><a href="Data.GS1.EPC.html#BizTransactionId"><span class="hs-identifier">BizTransactionId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BizTransactionId"><a href="Data.GS1.EPC.html#BizTransactionId"><span class="hs-identifier">BizTransactionId</span></a></a><span> </span><span class="hs-special">{</span><a name="unBizTransactionId"><a href="Data.GS1.EPC.html#unBizTransactionId"><span class="hs-identifier">unBizTransactionId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">}</span><span>
</span><a name="line-618"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-619"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionId"><span class="hs-identifier hs-type">BizTransactionId</span></a><span>
</span><a name="line-620"></a><span>
</span><a name="line-621"></a><span class="hs-keyword">data</span><span> </span><a name="BizTransactionType"><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier">BizTransactionType</span></a></a><span>
</span><a name="line-622"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Bol"><a href="Data.GS1.EPC.html#Bol"><span class="hs-identifier">Bol</span></a></a><span>       </span><span class="hs-comment">-- Bill of Lading</span><span>
</span><a name="line-623"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Desadv"><a href="Data.GS1.EPC.html#Desadv"><span class="hs-identifier">Desadv</span></a></a><span>    </span><span class="hs-comment">-- Dispatch Advice</span><span>
</span><a name="line-624"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Inv"><a href="Data.GS1.EPC.html#Inv"><span class="hs-identifier">Inv</span></a></a><span>       </span><span class="hs-comment">-- Invoice</span><span>
</span><a name="line-625"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Pedigree"><a href="Data.GS1.EPC.html#Pedigree"><span class="hs-identifier">Pedigree</span></a></a><span>  </span><span class="hs-comment">-- Pedigree</span><span>
</span><a name="line-626"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Po"><a href="Data.GS1.EPC.html#Po"><span class="hs-identifier">Po</span></a></a><span>        </span><span class="hs-comment">-- Purchase Order</span><span>
</span><a name="line-627"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Poc"><a href="Data.GS1.EPC.html#Poc"><span class="hs-identifier">Poc</span></a></a><span>       </span><span class="hs-comment">-- Purchase Order Confirmation</span><span>
</span><a name="line-628"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Prodorder"><a href="Data.GS1.EPC.html#Prodorder"><span class="hs-identifier">Prodorder</span></a></a><span> </span><span class="hs-comment">-- Production Order</span><span>
</span><a name="line-629"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Recadv"><a href="Data.GS1.EPC.html#Recadv"><span class="hs-identifier">Recadv</span></a></a><span>    </span><span class="hs-comment">-- Receiving Advice</span><span>
</span><a name="line-630"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Rma"><a href="Data.GS1.EPC.html#Rma"><span class="hs-identifier">Rma</span></a></a><span>       </span><span class="hs-comment">-- Return Mechandise Authorisation</span><span>
</span><a name="line-631"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-632"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679166290"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679166290"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679166290"><span class="hs-identifier hs-var">BizTransactionType</span></a><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier hs-type">BizTransactionType</span></a><span>
</span><a name="line-634"></a><span>
</span><a name="line-635"></a><span class="hs-identifier">ppBizTransactionType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier hs-type">BizTransactionType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-636"></a><a name="ppBizTransactionType"><a href="Data.GS1.EPC.html#ppBizTransactionType"><span class="hs-identifier">ppBizTransactionType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#revertCamelCase"><span class="hs-identifier hs-var">revertCamelCase</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-identifier">readURIBizTransactionType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier hs-type">BizTransactionType</span></a><span>
</span><a name="line-639"></a><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-640"></a><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier hs-type">BizTransactionType</span></a><span>
</span><a name="line-641"></a><a name="readURIBizTransactionType"><a href="Data.GS1.EPC.html#readURIBizTransactionType"><span class="hs-identifier">readURIBizTransactionType</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>    </span><a name="local-6989586621679166301"><a href="#local-6989586621679166301"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-var">XMLSnippet</span></a><span> </span><a href="#local-6989586621679166301"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span class="hs-identifier">readURIBizTransactionType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679166302"><a href="#local-6989586621679166302"><span class="hs-identifier">btt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679166302"><span class="hs-identifier hs-var">btt</span></a><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-comment">-- CBV-Standard-1-2-r-2016-09-29.pdf page 28</span><span>
</span><a name="line-645"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span> </span><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier hs-type">BizTransactionType</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-646"></a><span>  </span><a name="local-8214565720323921189"><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier">uriPrefix</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epcglobal:cbv:btt:&quot;</span><span>
</span><a name="line-647"></a><span>  </span><a name="local-8214565720323921190"><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier">uriSuffix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.GS1.EPC.html#ppBizTransactionType"><span class="hs-identifier hs-var">ppBizTransactionType</span></a><span>
</span><a name="line-648"></a><span>  </span><a name="local-8214565720323921191"><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier">readURI</span></a></a><span> </span><a name="local-6989586621679166299"><a href="#local-6989586621679166299"><span class="hs-identifier">s</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679166300"><a href="#local-6989586621679166300"><span class="hs-identifier">pURI</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a><span> </span><a href="#local-6989586621679166299"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-string">&quot;urn:epcglobal:cbv:btt&quot;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier hs-type">BizTransactionType</span></a><span>
</span><a name="line-649"></a><span>                      </span><span class="hs-keyword">in</span><span> </span><a href="Data.GS1.EPC.html#readURIBizTransactionType"><span class="hs-identifier hs-var">readURIBizTransactionType</span></a><span> </span><a href="#local-6989586621679166300"><span class="hs-identifier hs-var">pURI</span></a><span> </span><a href="#local-6989586621679166299"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-650"></a><span>
</span><a name="line-651"></a><span class="hs-comment">-- |BizTransaction CBV Section 7.3 and Section 8.5</span><span>
</span><a name="line-652"></a><span class="hs-keyword">data</span><span> </span><a name="BizTransaction"><a href="Data.GS1.EPC.html#BizTransaction"><span class="hs-identifier">BizTransaction</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BizTransaction"><a href="Data.GS1.EPC.html#BizTransaction"><span class="hs-identifier">BizTransaction</span></a></a><span>
</span><a name="line-653"></a><span>  </span><span class="hs-special">{</span><span>
</span><a name="line-654"></a><span>    </span><a name="_btid"><a href="Data.GS1.EPC.html#_btid"><span class="hs-identifier">_btid</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionId"><span class="hs-identifier hs-type">BizTransactionId</span></a><span>
</span><a name="line-655"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_bt"><a href="Data.GS1.EPC.html#_bt"><span class="hs-identifier">_bt</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#BizTransactionType"><span class="hs-identifier hs-type">BizTransactionType</span></a><span>
</span><a name="line-656"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-657"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-658"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679166728"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679166728"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679166728"><span class="hs-identifier hs-var">BizTransaction</span></a><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#BizTransaction"><span class="hs-identifier hs-type">BizTransaction</span></a><span>
</span><a name="line-660"></a><span>
</span><a name="line-661"></a><span>
</span><a name="line-662"></a><span class="hs-comment">-- | TransformationId</span><span>
</span><a name="line-663"></a><span class="hs-comment">-- From the spec EPCIS-Standard-1.2-r-2016-09-29.pdf Page 55</span><span>
</span><a name="line-664"></a><span class="hs-comment">-- Some transformation business processes take place over a long period of time, and so it is more</span><span>
</span><a name="line-665"></a><span class="hs-comment">-- appropriate to represent them as a series of EPCIS events. A TransfomationId may be included</span><span>
</span><a name="line-666"></a><span class="hs-comment">-- in two or more TransformationEvents to link them together. When events share an identical</span><span>
</span><a name="line-667"></a><span class="hs-comment">-- TransformationId, the meaning is that the inputs to any of those events may have contributed in</span><span>
</span><a name="line-668"></a><span class="hs-comment">-- some way to each of the outputs in any of those same events.</span><span>
</span><a name="line-669"></a><span class="hs-keyword">newtype</span><span> </span><a name="TransformationId"><a href="Data.GS1.EPC.html#TransformationId"><span class="hs-identifier">TransformationId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TransformationId"><a href="Data.GS1.EPC.html#TransformationId"><span class="hs-identifier">TransformationId</span></a></a><span> </span><span class="hs-special">{</span><a name="unTransformationId"><a href="Data.GS1.EPC.html#unTransformationId"><span class="hs-identifier">unTransformationId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">UUID</span><span class="hs-special">}</span><span>
</span><a name="line-670"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-671"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#TransformationId"><span class="hs-identifier hs-type">TransformationId</span></a><span>
</span><a name="line-672"></a><span>
</span><a name="line-673"></a><span class="hs-keyword">data</span><span> </span><a name="Action"><a href="Data.GS1.EPC.html#Action"><span class="hs-identifier">Action</span></a></a><span>
</span><a name="line-674"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Add"><a href="Data.GS1.EPC.html#Add"><span class="hs-identifier">Add</span></a></a><span>
</span><a name="line-675"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Observe"><a href="Data.GS1.EPC.html#Observe"><span class="hs-identifier">Observe</span></a></a><span>
</span><a name="line-676"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Delete"><a href="Data.GS1.EPC.html#Delete"><span class="hs-identifier">Delete</span></a></a><span>
</span><a name="line-677"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-678"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679167505"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679167505"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679167505"><span class="hs-identifier hs-var">Action</span></a><span class="hs-special">)</span><span>
</span><a name="line-679"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#Action"><span class="hs-identifier hs-type">Action</span></a><span>
</span><a name="line-680"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToParamSchema</span><span> </span><a href="Data.GS1.EPC.html#Action"><span class="hs-identifier hs-type">Action</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-681"></a><span>  </span><a name="local-8214565720323808891"><span class="hs-identifier">toParamSchema</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-682"></a><span>    </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">type_</span><span> </span><span class="hs-operator hs-var">.~</span><span> </span><span class="hs-identifier hs-var">SwaggerString</span><span>
</span><a name="line-683"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromHttpApiData</span><span> </span><a href="Data.GS1.EPC.html#Action"><span class="hs-identifier hs-type">Action</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-684"></a><span>  </span><a name="local-8214565720323800232"><span class="hs-identifier">parseQueryParam</span></a><span> </span><a name="local-6989586621679167532"><a href="#local-6989586621679167532"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">first</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#mkAction"><span class="hs-identifier hs-var">mkAction</span></a><span> </span><a href="#local-6989586621679167532"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span class="hs-identifier">mkAction</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#Action"><span class="hs-identifier hs-type">Action</span></a><span>
</span><a name="line-687"></a><a name="mkAction"><a href="Data.GS1.EPC.html#mkAction"><span class="hs-identifier">mkAction</span></a></a><span> </span><a name="local-6989586621679167533"><a href="#local-6989586621679167533"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-688"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Data.GS1.Utils.html#mkByName"><span class="hs-identifier hs-var">mkByName</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.GS1.Utils.html#camelCase"><span class="hs-identifier hs-var">camelCase</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toLower</span><span> </span><a href="#local-6989586621679167533"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-689"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#InvalidAction"><span class="hs-identifier hs-var">InvalidAction</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-var">XMLSnippet</span></a><span> </span><a href="#local-6989586621679167533"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-690"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679167534"><a href="#local-6989586621679167534"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679167534"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-693"></a><span class="hs-comment">-- WHY  -------------------</span><span>
</span><a name="line-694"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-keyword">data</span><span> </span><a name="Disposition"><a href="Data.GS1.EPC.html#Disposition"><span class="hs-identifier">Disposition</span></a></a><span>
</span><a name="line-697"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Active"><a href="Data.GS1.EPC.html#Active"><span class="hs-identifier">Active</span></a></a><span>
</span><a name="line-698"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ContainerClosed"><a href="Data.GS1.EPC.html#ContainerClosed"><span class="hs-identifier">ContainerClosed</span></a></a><span>
</span><a name="line-699"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Damaged"><a href="Data.GS1.EPC.html#Damaged"><span class="hs-identifier">Damaged</span></a></a><span>
</span><a name="line-700"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Destroyed"><a href="Data.GS1.EPC.html#Destroyed"><span class="hs-identifier">Destroyed</span></a></a><span>
</span><a name="line-701"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Dispensed"><a href="Data.GS1.EPC.html#Dispensed"><span class="hs-identifier">Dispensed</span></a></a><span>
</span><a name="line-702"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Disposed"><a href="Data.GS1.EPC.html#Disposed"><span class="hs-identifier">Disposed</span></a></a><span>
</span><a name="line-703"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Encoded"><a href="Data.GS1.EPC.html#Encoded"><span class="hs-identifier">Encoded</span></a></a><span>
</span><a name="line-704"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Expired"><a href="Data.GS1.EPC.html#Expired"><span class="hs-identifier">Expired</span></a></a><span>
</span><a name="line-705"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InProgress"><a href="Data.GS1.EPC.html#InProgress"><span class="hs-identifier">InProgress</span></a></a><span>
</span><a name="line-706"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="InTransit"><a href="Data.GS1.EPC.html#InTransit"><span class="hs-identifier">InTransit</span></a></a><span>
</span><a name="line-707"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Inactive"><a href="Data.GS1.EPC.html#Inactive"><span class="hs-identifier">Inactive</span></a></a><span>
</span><a name="line-708"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NoPedigreeMatch"><a href="Data.GS1.EPC.html#NoPedigreeMatch"><span class="hs-identifier">NoPedigreeMatch</span></a></a><span>
</span><a name="line-709"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NonSellableOther"><a href="Data.GS1.EPC.html#NonSellableOther"><span class="hs-identifier">NonSellableOther</span></a></a><span>
</span><a name="line-710"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PartiallyDispensed"><a href="Data.GS1.EPC.html#PartiallyDispensed"><span class="hs-identifier">PartiallyDispensed</span></a></a><span>
</span><a name="line-711"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Recalled"><a href="Data.GS1.EPC.html#Recalled"><span class="hs-identifier">Recalled</span></a></a><span>
</span><a name="line-712"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Reserved"><a href="Data.GS1.EPC.html#Reserved"><span class="hs-identifier">Reserved</span></a></a><span>
</span><a name="line-713"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RetailSold"><a href="Data.GS1.EPC.html#RetailSold"><span class="hs-identifier">RetailSold</span></a></a><span>
</span><a name="line-714"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Returned"><a href="Data.GS1.EPC.html#Returned"><span class="hs-identifier">Returned</span></a></a><span>
</span><a name="line-715"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SellableAccessible"><a href="Data.GS1.EPC.html#SellableAccessible"><span class="hs-identifier">SellableAccessible</span></a></a><span>
</span><a name="line-716"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SellableNotAccessible"><a href="Data.GS1.EPC.html#SellableNotAccessible"><span class="hs-identifier">SellableNotAccessible</span></a></a><span>
</span><a name="line-717"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Stolen"><a href="Data.GS1.EPC.html#Stolen"><span class="hs-identifier">Stolen</span></a></a><span>
</span><a name="line-718"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Unknown"><a href="Data.GS1.EPC.html#Unknown"><span class="hs-identifier">Unknown</span></a></a><span>
</span><a name="line-719"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-720"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679169222"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679169222"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679169222"><span class="hs-identifier hs-var">Disposition</span></a><span class="hs-special">)</span><span>
</span><a name="line-721"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#Disposition"><span class="hs-identifier hs-type">Disposition</span></a><span>
</span><a name="line-722"></a><span>
</span><a name="line-723"></a><span>
</span><a name="line-724"></a><span class="hs-identifier">ppDisposition</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.GS1.EPC.html#Disposition"><span class="hs-identifier hs-type">Disposition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-725"></a><a name="ppDisposition"><a href="Data.GS1.EPC.html#ppDisposition"><span class="hs-identifier">ppDisposition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#revertCamelCase"><span class="hs-identifier hs-var">revertCamelCase</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span>
</span><a name="line-726"></a><span>
</span><a name="line-727"></a><span class="hs-comment">-- CBV-Standard-1-2-r-2016-09-29.pdf page 24</span><span>
</span><a name="line-728"></a><span class="hs-identifier">readURIDisposition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#Disposition"><span class="hs-identifier hs-type">Disposition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.GS1.EPC.html#ParseFailure"><span class="hs-identifier hs-type">ParseFailure</span></a><span> </span><a href="Data.GS1.EPC.html#Disposition"><span class="hs-identifier hs-type">Disposition</span></a><span>
</span><a name="line-729"></a><a name="readURIDisposition"><a href="Data.GS1.EPC.html#readURIDisposition"><span class="hs-identifier">readURIDisposition</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><a name="local-6989586621679169343"><a href="#local-6989586621679169343"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#InvalidFormat"><span class="hs-identifier hs-var">InvalidFormat</span></a><span> </span><span class="hs-special">(</span><a href="Data.GS1.EPC.html#XMLSnippet"><span class="hs-identifier hs-var">XMLSnippet</span></a><span> </span><a href="#local-6989586621679169343"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span class="hs-identifier">readURIDisposition</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679169344"><a href="#local-6989586621679169344"><span class="hs-identifier">disp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679169344"><span class="hs-identifier hs-var">disp</span></a><span>
</span><a name="line-731"></a><span>
</span><a name="line-732"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.GS1.EPC.html#URI"><span class="hs-identifier hs-type">URI</span></a><span> </span><a href="Data.GS1.EPC.html#Disposition"><span class="hs-identifier hs-type">Disposition</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-733"></a><span>  </span><a name="local-8214565720323921189"><a href="Data.GS1.EPC.html#uriPrefix"><span class="hs-identifier">uriPrefix</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;urn:epcglobal:cbv:disp:&quot;</span><span>
</span><a name="line-734"></a><span>  </span><a name="local-8214565720323921190"><a href="Data.GS1.EPC.html#uriSuffix"><span class="hs-identifier">uriSuffix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.GS1.EPC.html#ppDisposition"><span class="hs-identifier hs-var">ppDisposition</span></a><span>
</span><a name="line-735"></a><span>  </span><a name="local-8214565720323921191"><a href="Data.GS1.EPC.html#readURI"><span class="hs-identifier">readURI</span></a></a><span>  </span><a name="local-6989586621679169341"><a href="#local-6989586621679169341"><span class="hs-identifier">s</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679169342"><a href="#local-6989586621679169342"><span class="hs-identifier">pURI</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.GS1.Utils.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a><span> </span><a href="#local-6989586621679169341"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-string">&quot;urn:epcglobal:cbv:disp&quot;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.GS1.EPC.html#Disposition"><span class="hs-identifier hs-type">Disposition</span></a><span>
</span><a name="line-736"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><a href="Data.GS1.EPC.html#readURIDisposition"><span class="hs-identifier hs-var">readURIDisposition</span></a><span> </span><a href="#local-6989586621679169342"><span class="hs-identifier hs-var">pURI</span></a><span> </span><a href="#local-6989586621679169341"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-737"></a><span>
</span><a name="line-738"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-739"></a><span class="hs-comment">-- WHEN  -------------------</span><span>
</span><a name="line-740"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-741"></a><span class="hs-comment">{-
   A timestamp, giving the date and time in a time zone-independent manner.
   For bindings in which fields of this type are represented textually,
   an ISO-8601 compliant representation SHOULD be used.
-}</span><span>
</span><a name="line-746"></a><span class="hs-comment">-- |The TimeZone will be saved independently</span><span>
</span><a name="line-747"></a><span class="hs-keyword">newtype</span><span> </span><a name="EPCISTime"><a href="Data.GS1.EPC.html#EPCISTime"><span class="hs-identifier">EPCISTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EPCISTime"><a href="Data.GS1.EPC.html#EPCISTime"><span class="hs-identifier">EPCISTime</span></a></a><span> </span><span class="hs-special">{</span><a name="unEPCISTime"><a href="Data.GS1.EPC.html#unEPCISTime"><span class="hs-identifier">unEPCISTime</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">UTCTime</span><span class="hs-special">}</span><span>
</span><a name="line-748"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-749"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#EPCISTime"><span class="hs-identifier hs-type">EPCISTime</span></a><span>
</span><a name="line-750"></a><span>
</span><a name="line-751"></a><span class="hs-keyword">data</span><span> </span><a name="EPCISTimeError"><a href="Data.GS1.EPC.html#EPCISTimeError"><span class="hs-identifier">EPCISTimeError</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="IllegalTimeFormat"><a href="Data.GS1.EPC.html#IllegalTimeFormat"><span class="hs-identifier">IllegalTimeFormat</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-752"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679170351"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679170351"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679170351"><span class="hs-identifier hs-var">EPCISTimeError</span></a><span class="hs-special">)</span><span>
</span><a name="line-753"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><a href="Data.GS1.EPC.html#EPCISTimeError"><span class="hs-identifier hs-type">EPCISTimeError</span></a><span>
</span><a name="line-754"></a><span>
</span><a name="line-755"></a><span>
</span><a name="line-756"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-identifier hs-type">ZonedTime</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-757"></a><span>  </span><a name="local-6989586621679170354"><a href="#local-6989586621679170354"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679170355"><a href="#local-6989586621679170355"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679170354"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679170355"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-758"></a><span>
</span><a name="line-759"></a><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-6989586621679170885"><span class="hs-identifier hs-var">deriveJSON</span></a><span> </span><a href="#local-6989586621679170885"><span class="hs-identifier hs-var">defaultOptions</span></a><span> </span><span class="hs-special">''</span><a href="#local-6989586621679170885"><span class="hs-identifier hs-var">TimeZone</span></a><span class="hs-special">)</span><span>
</span><a name="line-760"></a><span class="hs-comment">--instance ToSchema ZonedTime</span><span>
</span><a name="line-761"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToParamSchema</span><span> </span><span class="hs-identifier hs-type">TimeZone</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-762"></a><span>  </span><a name="local-8214565720323808891"><span class="hs-identifier">toParamSchema</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-763"></a><span>    </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">type_</span><span> </span><span class="hs-operator hs-var">.~</span><span> </span><span class="hs-identifier hs-var">SwaggerString</span><span>
</span><a name="line-764"></a><span>
</span><a name="line-765"></a><span class="hs-comment">-- copied from</span><span>
</span><a name="line-766"></a><span class="hs-comment">-- https://hackage.haskell.org/package/swagger2-2.1.3/docs/src/Data.Swagger.Internal.Schema.html#line-477</span><span>
</span><a name="line-767"></a><span class="hs-identifier">named</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Schema</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NamedSchema</span><span>
</span><a name="line-768"></a><a name="named"><a href="Data.GS1.EPC.html#named"><span class="hs-identifier">named</span></a></a><span> </span><a name="local-6989586621679170890"><a href="#local-6989586621679170890"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NamedSchema</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679170890"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- this function has been Eta reduced</span><span>
</span><a name="line-769"></a><span>
</span><a name="line-770"></a><span class="hs-identifier">timeSchema</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Schema</span><span>
</span><a name="line-771"></a><a name="timeSchema"><a href="Data.GS1.EPC.html#timeSchema"><span class="hs-identifier">timeSchema</span></a></a><span> </span><a name="local-6989586621679170891"><a href="#local-6989586621679170891"><span class="hs-identifier">fmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-772"></a><span>  </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">type_</span><span> </span><span class="hs-operator hs-var">.~</span><span> </span><span class="hs-identifier hs-var">SwaggerString</span><span>
</span><a name="line-773"></a><span>  </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">format</span><span> </span><span class="hs-operator hs-var">?~</span><span> </span><a href="#local-6989586621679170891"><span class="hs-identifier hs-var">fmt</span></a><span>
</span><a name="line-774"></a><span>
</span><a name="line-775"></a><span>
</span><a name="line-776"></a><span class="hs-comment">-- XXX I have literally no idea what is happening here! Please check!</span><span>
</span><a name="line-777"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToSchema</span><span> </span><span class="hs-identifier hs-type">TimeZone</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-778"></a><span>  </span><a name="local-8214565720323808821"><span class="hs-identifier">declareNamedSchema</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#named"><span class="hs-identifier hs-var">named</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-string">&quot;TimeZone&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.GS1.EPC.html#timeSchema"><span class="hs-identifier hs-var">timeSchema</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-string">&quot;date-time&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-779"></a></pre></body></html>